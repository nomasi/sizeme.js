{"version":3,"sources":["sizeme-ui.js"],"names":["window","SizeMeI18N","defaultLang","defLang","languages","this","add","lang","langObj","get","FIT_VERDICT","not_fitted","too_small","slim","regular","loose","very_loose","huge","too_big","FIT_VERDICT_LONG","MEASUREMENT","chest","waist","sleeve","sleeve_top_width","sleeve_top_opening","wrist_width","underbust","neck_opening_width","shoulder_width","front_height","pant_waist","hips","inseam","outseam","thigh_width","knee_width","calf_width","pant_sleeve_width","shoe_inside_length","shoe_inside_width","hat_width","hood_height","hem","sleeve_opening","COMMON","shopping_for","selected_size","is","add_to_profile","size","fetching_profiles","close_text","go_to","my_profiles","and_create_one","MESSAGE","add_profiles","missing_measurements","no_measurements","add_this_measurement","no_profiles","no_top_button","DETAILED","window_title","button_text","table_title","SIZE_GUIDE","measurement_disclaimer","measurement_disclaimer_collar","measurement_disclaimer_inside","advertisement","FIT_INFO","when_pinched","stretched_little","stretched_somewhat","stretched_much","stretched_max","the_item","the_measurement","no_overlap","is_smaller","overlaps_you","arm_sleeve_straight","sm_considers_fit","overall_fit","overall_fit_for_size","SPLASH","detailed_text","btn_sign_up_title","btn_sign_up_label","btn_log_in_title","btn_log_in_label","btn_no_thanks_title","btn_no_thanks_label","product_page_splashes","product_page_splash_title","$","sizeText","txt","retStr","split","getFit","fitValue","importance","returnFit","singleFit","ranges","FIT_RANGES_LESS_IMPORTANCE","FIT_RANGES","hasOwnProperty","addIds","parentElement","each","myVal","val","myText","text","addClass","id","sizeme_product","item","measurements","sizeKeys","push","key","sizeLabel","getItemTypeArr","itemTypeStr","itemType","toString","itemTypeArr","separator","indexOf","itemTypeSplitted","i","length","isInside","loadArrows","isSizeGuide","$i","$x","arrowColor","arrowColorGreen","arcStyle","arrowColorBlack","measurement_arrows","mirror","coords","X","Y","style","lift","color","cp1X","cp1Y","cp2X","cp2Y","midCircle","item_drawing","accents","i18n","type","noMirror","R","FIT_ORDER","splice","Math","round","$base_y","getSliderHtml","systemsGo","sliderHtml","basePosX","cellTitle","sizeme_local_options","fitAreaSlider","perc_width","sliderScale","label","sliderPos","offset","returnPos","min","sliderPosXMax","sliderPosXMin","max","killExtraSlider","remove","drawExtraSlider","hide","appendTo","fadeIn","fadeLength","newWidth","width","moveSlider","shouldAnimate","stop","animate","moveAreaSlider","matchMap","endX","startX","newMarginLeft","smallestFit","biggestFit","measurement","isImportant","componentFit","marginLeft","css","goWriteMessages","missingMeasurements","accuracy","$message","$message_type","$message_link","empty","selectedProfile","linkToSelectedProfile","accuracyThreshold","overlap","attr","selectToButtons","element","numClass","$content","document","createElement","thisId","thisLabel","thisClass","thisVal","$div","on","find","removeClass","sizeme_UI_options","sizeSelectionContainer","change","SizeMe","trackEvent","append","getMaxY","data","getMaxX","getMinX","getMinY","getArced","p1","p2","dX","arcRadius","liftCoords","nX","nY","dY","angleA","atan2","sin","arrowLift","cos","getMidPoints","mid","plotItem","c","isArrow","scale","offsetX","offsetY","highlighted","pX","coord","pY","j","lcp","beginPath","lineWidth","arrowLineWidth","moveTo","bezierCurveTo","lineTo","stroke","arc","arrowEndRadius","PI","fill","rad","arrowNumberRadius","fillStyle","font","arrowNumberFont","textAlign","textBaseline","arrowNumberHighlightFont","fillText","num","fillColor","strokeStyle","drawColor","itemLineWidth","lineCap","lineJoin","miterLimit","realCanvasWidth","writeItemCanvas","canvas_id","highlight","getElementById","getContext","realCanvasHeight","canvasWidth","padding","canvasHeight","maxX","maxY","inputKey","draw","Object","keys","initOpentip","Opentip","lastZIndex","styles","myDefaultStyle","group","defaultStyle","hasNeckOpening","retval","undefined","noThanks","readCookie","noProductSplash","writeDetailedWindow","itemName","name","txts","linkTarget","appendContentTo","$dialog","dialog","position","my","at","of","autoOpen","dialogClass","minHeight","minWidth","scaleH","scaleW","closeText","title","click","$clone","clone","$slider_clone","end","$matchMap","$txt","sizeme_options","service_status","contextAddress","clearAuthToken","eraseCookie","colorCell","$cell","value","arrow","arrowColorInfo","selectedFit","getMissingMeasurement","isPinched","PINCHED_FITS","isLongFit","LONG_FITS","isPinchedTxt","getStretchedTxt","stretch_value","updateDetailedTable","$row","$tip","$table","html","$tip_txts","$tip_classes","writeOverlaps","drawReason","$meas_top","toLowerCase","toFixed","$sleeve_txt","$sleeve_height","percentage","$front_height_txt","$front_height_height","componentStretch","replace","$fitVerdict","className","missing","$class","$j","$first","updateDetailedSliderTip","thisSize","thisFit","$trigger","$tip_txt","updateSlider","thisData","isRecommended","detailedContainer","animateSlider","totalFit","fitRangeLabel","writeMessages","getStandardHeader","headerHtml","getSplashDetailed","getProductSplash","splashHtml","findMaxMeasurement","maxVal","measurement_set","key_2","Storage","withStorage","storage","removeItem","getAuthToken","deferred","Deferred","storedToken","storedTokenObj","getItem","JSON","parse","expires","Date","getTime","token","resolve","reject","state","authTokenObj","setItem","stringify","promise","sizeMeInit","authorizedCb","unauthorizedCb","then","authToken","sizeMe","smObj","isLoggedIn","createCookie","days","date","setTime","toGMTString","cookie","ca","trim","recommendedId",1,940,1000,1055,1110,1165,1225,"OPTIMAL_FIT","recommendedLabel","cookieLifetime","firstRecommendation","DataStorage","storageAvailable","_tstorage","x","e","prototype","callback","buttonize","addToCartEvent","addToCartElement","getMatchResponseHandler","prodId","responseMap","smallestOffset","result","classKey","fitOffset","abs","show","detailedViewContainer","recommendedInput","matchErrorHandler","console","error","loggedInCb","sizeMeObj","setProfileLink","doProfileChange","newValue","tmpItem","extend","join","match","FitRequest","fetchProfilesForAccount","profileList","cookieProfile","$new","toggleClass","select","profileName","loggedOutCb","splashContent","loginFrame","trigger","appendSplashTo","slideUp","jQuery"],"mappings":"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","file":"sizeme-ui.min.js","sourcesContent":["(function(window) {\r\n    \"use strict\";\r\n\r\n    var SizeMeI18N = function (defaultLang) {\r\n        var defLang = defaultLang || \"en\";\r\n\r\n        var languages = {};\r\n        languages[defLang] = {};\r\n\r\n        this.add = function (lang, langObj) {\r\n            languages[lang] = langObj;\r\n        };\r\n\r\n        this.get = function (lang) {\r\n            return languages[lang] || languages[defLang];\r\n        };\r\n    };\r\n\r\n    window.SizeMeI18N = new SizeMeI18N(\"en\");\r\n\r\n})(window);\n(function (window) {\r\n    \"use strict\";\r\n\r\n    window.SizeMeI18N.add(\"en\",\r\n        {\r\n            FIT_VERDICT: {\r\n                not_fitted: \"Too small\",\r\n                too_small: \"Too small\",\r\n                slim: \"Slim\",\r\n                regular: \"Regular\",\r\n                loose: \"Loose\",\r\n                very_loose: \"Very loose\",\r\n                huge: \"Huge\",\r\n                too_big: \"Too big\"\r\n\t\t\t},\r\n            FIT_VERDICT_LONG: {\r\n                not_fitted: \"Too short\",\r\n                too_small: \"Too short\",\r\n                slim: \"Short\",\r\n                regular: \"Regular\",\r\n                loose: \"Long\",\r\n                very_loose: \"Very long\",\r\n                huge: \"Huge\",\r\n                too_big: \"Too long\"\r\n            },\r\n\t\t\tMEASUREMENT: {\r\n                chest: \"Chest\",\r\n                waist: \"Waist\",\r\n                sleeve: \"Sleeve\",\r\n                sleeve_top_width: \"Sleeve top\",\r\n                sleeve_top_opening: \"Sleeve top opening\",\r\n                wrist_width: \"Wrist\",\r\n                underbust: \"Underbust\",\r\n                neck_opening_width: \"Collar\",\r\n                shoulder_width: \"Shoulder\",\r\n                front_height: \"Front height\",\r\n                pant_waist: \"Pant waist\",\r\n                hips: \"Hips\",\r\n                inseam: \"Inseam\",\r\n                outseam: \"Outseam\",\r\n                thigh_width: \"Thigh\",\r\n                knee_width: \"Knee\",\r\n                calf_width: \"Calf\",\r\n                pant_sleeve_width: \"Leg opening\",\r\n                shoe_inside_length: \"Shoe length\",\r\n                shoe_inside_width: \"Shoe width\",\r\n                hat_width: \"Hat circumference\",\r\n                hood_height: \"Hood height\",\r\n\t\t\t\them: \"Hem\",\r\n\t\t\t\tsleeve_opening: \"Sleeve opening\"\r\n            },\r\n\t\t\tCOMMON: {\r\n\t\t\t\tshopping_for: \"Shopping for\",\r\n\t\t\t\tselected_size: \"Selected size\",\r\n\t\t\t\tis: \"is\",\t// verb\r\n\t\t\t\tadd_to_profile: \"Add to profile\",\r\n\t\t\t\tsize: \"Size\",\r\n\t\t\t\tfetching_profiles: \"Fetching profiles...\",\r\n\t\t\t\tclose_text: \"Close\",\r\n\t\t\t\tgo_to: \"Go to\",\r\n\t\t\t\tmy_profiles: \"My Profiles\",\r\n\t\t\t\tand_create_one: \"and create one.\"\t// as in: go to my profiles and create one\r\n\t\t\t},\r\n\t\t\tMESSAGE: {\r\n\t\t\t\tadd_profiles: \"Add profiles to your account for a size recommendation.\",\r\n\t\t\t\tmissing_measurements: \"Add more measurements to your profile for increased accuracy\",\r\n\t\t\t\tno_measurements: \"Add measurements to your profile for a size recommendation.\",\r\n\t\t\t\tadd_this_measurement: \"Add this measurement to your profile to include it in the fit calculation.\",\r\n\t\t\t\tno_profiles: \"You have no profiles on your account.\",\r\n\t\t\t\tno_top_button: \"The shirt's top button for this size won't close.\"\r\n\t\t\t},\r\n\t\t\tDETAILED: {\r\n\t\t\t\twindow_title: \"Detailed View for\",\r\n\t\t\t\tbutton_text: \"Detailed view of fit\",\r\n\t\t\t\ttable_title: \"Detailed fit - overlaps\"\r\n\t\t\t},\r\n\t\t\tSIZE_GUIDE: {\r\n\t\t\t\twindow_title: \"Size Guide for\",\r\n\t\t\t\tbutton_text: \"Size guide\",\r\n\t\t\t\ttable_title: \"Actual item measurements\",\r\n\t\t\t\tmeasurement_disclaimer: \"These measurements are measured <u>flat across the outside of the item</u>.\",\r\n\t\t\t\tmeasurement_disclaimer_collar: \"Except for the collar measurement, which is measured around the inside of the collar.\",\r\n\t\t\t\tmeasurement_disclaimer_inside: \"These measurements are measured <u>inside the item</u>.\",\r\n\t\t\t\tadvertisement: \"This size guide is brought to you by\"\r\n\t\t\t},\r\n\t\t\tFIT_INFO: {\r\n\t\t\t\twhen_pinched: \" when pinched\",\r\n\t\t\t\tstretched_little: \"The item is stretched a little.\",\r\n\t\t\t\tstretched_somewhat: \"The item is stretched.\",\r\n\t\t\t\tstretched_much: \"The item is stretched a lot.\",\r\n\t\t\t\tstretched_max: \"The item is stretched to the max.\",\r\n\t\t\t\tthe_item: \"The item's\",\r\n\t\t\t\tthe_measurement: \"measurement\",\r\n\t\t\t\tno_overlap: \"is directly on you with no overlap.\",\r\n\t\t\t\tis_smaller: \"is <u>smaller</u> than your matching measurement by\",\r\n\t\t\t\toverlaps_you: \"overlaps you by\",\r\n\t\t\t\tarm_sleeve_straight: \"when your arm and the item's sleeve are <u>completely straight</u>\",\r\n\t\t\t\tsm_considers_fit: \"SizeMe considers this particular fit\",\r\n\t\t\t\toverall_fit: \"Overall fit\",\r\n\t\t\t\toverall_fit_for_size: \"The overall fit for <b>size\"\r\n\t\t\t},\r\n\t\t\tSPLASH: {\r\n\t\t\t\tdetailed_text: \"Take a few <b>measurements of yourself</b> and get personalized info on how this item would <b>fit you</b>.<br />Create a free <b>SizeMe</b> profile and stop guessing!\",\r\n\t\t\t\tbtn_sign_up_title: \"Sign up\",\r\n\t\t\t\tbtn_sign_up_label: \"Yes, I'd like to create a free account\",\r\n\t\t\t\tbtn_log_in_title: \"Log in\",\r\n\t\t\t\tbtn_log_in_label: \"I already have an account\",\r\n\t\t\t\tbtn_no_thanks_title: \"No thanks\",\r\n\t\t\t\tbtn_no_thanks_label: \"Maybe later\",\r\n\t\t\t\tproduct_page_splashes: [\"Unsure about the right size? Try\"],\r\n\t\t\t\tproduct_page_splash_title: \"SizeMe is a free service to help you know how this item will fit _you_\"\r\n\t\t\t}\r\n        }\r\n    );\r\n\r\n})(window);\n(function (window) {\r\n    \"use strict\";\r\n\r\n    window.SizeMeI18N.add(\"fi\",\r\n        {\r\n            FIT_VERDICT: {\r\n                not_fitted: \"Pieni\",\r\n                too_small: \"Pieni\",\r\n                slim: \"Kapea\",\r\n                regular: \"Normaali\",\r\n                loose: \"Vlj\",\r\n                very_loose: \"Erittin vlj\",\r\n                huge: \"Valtava\",\r\n                too_big: \"Liian iso\"\r\n\t\t\t},\r\n            FIT_VERDICT_LONG: {\r\n                not_fitted: \"Liian lyhyt\",\r\n                too_small: \"Liian lyhyt\",\r\n                slim: \"Lyhyehk\",\r\n                regular: \"Normaali\",\r\n                loose: \"Pitkhk\",\r\n                very_loose: \"Pitk\",\r\n                huge: \"Valtava\",\r\n                too_big: \"Liian pitk\"\r\n            },\r\n\t\t\tMEASUREMENT: {\t\t\t\r\n                chest: \"Rinta\",\r\n                waist: \"Vytr\",\r\n                sleeve: \"Hiha\",\r\n                sleeve_top_width: \"Hihan ylosa\",\r\n                sleeve_top_opening: \"Hihan leveys\",\r\n                wrist_width: \"Ranne\",\r\n                underbust: \"Rinnan alta\",\r\n                neck_opening_width: \"Kaulus\",\r\n                shoulder_width: \"Hartia\",\r\n                front_height: \"Etupituus\",\r\n                pant_waist: \"Housun vytr\",\r\n                hips: \"Lantio\",\r\n                inseam: \"Sissauma\",\r\n                outseam: \"Ulkosauma\",\r\n                thigh_width: \"Reisi\",\r\n                knee_width: \"Polvi\",\r\n                calf_width: \"Pohje\",\r\n                pant_sleeve_width: \"Lahje\",\r\n                shoe_inside_length: \"Sispituus\",\r\n                shoe_inside_width: \"Sisleveys\",\r\n                hat_width: \"Ymprysmitta\",\r\n                hood_height: \"Hupun korkeus\",\r\n\t\t\t\them: \"Helma\",\r\n\t\t\t\tsleeve_opening: \"Hihan suu\"\t\t\t\t\r\n            },\r\n\t\t\tCOMMON: {\r\n\t\t\t\tshopping_for: \"Aktiivinen profiili\",\r\n\t\t\t\tselected_size: \"Valittu koko\",\r\n\t\t\t\tis: \"on\",\t// verb\r\n\t\t\t\tadd_to_profile: \"Lis profiiliin\",\r\n\t\t\t\tsize: \"Koko\",\r\n\t\t\t\tfetching_profiles: \"Haetaan profiileja...\",\r\n\t\t\t\tclose_text: \"Sulje\",\r\n\t\t\t\tgo_to: \"Mene\",\r\n\t\t\t\tmy_profiles: \"Profiili-sivulleni\",\r\n\t\t\t\tand_create_one: \"ja luo profiili.\"\t// as in: go to my profiles and create one\r\n\t\t\t},\r\n\t\t\tMESSAGE: {\r\n\t\t\t\tadd_profiles: \"Lis mittaprofiili kokosuositusta varten.\",\r\n\t\t\t\tmissing_measurements: \"Lis mittoja profiiliisi tarkempaa tulosta varten\",\r\n\t\t\t\tno_measurements: \"Lis mittoja profiiliisi kokosuositusta varten.\",\r\n\t\t\t\tadd_this_measurement: \"Lis tm mitta profiilisi tarkempaa tulosta varten.\",\r\n\t\t\t\tno_profiles: \"Tilillsi ei ole yhtn mittaprofiilia.\",\r\n\t\t\t\tno_top_button: \"Paidan ylin nappi ei tss koossa mene kiinni.\"\r\n\t\t\t},\r\n\t\t\tDETAILED: {\r\n\t\t\t\twindow_title: \"Sopivuustiedot tuotteelle\",\r\n\t\t\t\tbutton_text: \"Sopivuustiedot\",\r\n\t\t\t\ttable_title: \"Sopivuustiedot\"\r\n\t\t\t},\r\n\t\t\tSIZE_GUIDE: {\r\n\t\t\t\twindow_title: \"Kokotaulukko tuotteelle\",\r\n\t\t\t\tbutton_text: \"Kokotaulukko\",\r\n\t\t\t\ttable_title: \"Tuotteen mitat\",\r\n\t\t\t\tmeasurement_disclaimer: \"Nm mitat on otettu <u>tuotteen plt tasaisella alustalla</u>.\",\r\n\t\t\t\tmeasurement_disclaimer_collar: \"Paitsi kaulus, joka on ymprysmitta kauluksen sispuolelta.\",\r\n\t\t\t\tmeasurement_disclaimer_inside: \"Nm mitat on otettu <u>tuotteen sislt</u>.\",\r\n\t\t\t\tadvertisement: \"Tmn kokotaulukon toimittaa\"\r\n\t\t\t},\r\n\t\t\tFIT_INFO: {\r\n\t\t\t\twhen_pinched: \" nipistettyn sormien vliin\",\r\n\t\t\t\tstretched_little: \"Tuote venyy vhn.\",\r\n\t\t\t\tstretched_somewhat: \"Tuote venyy.\",\r\n\t\t\t\tstretched_much: \"Tuote venyy kunnolla.\",\r\n\t\t\t\tstretched_max: \"Tuote venyy huolella.\",\r\n\t\t\t\tthe_item: \"Tuotteen\",\r\n\t\t\t\tthe_measurement: \"-mitta\",\r\n\t\t\t\tno_overlap: \"on suoraan sinua vasten.\",\r\n\t\t\t\tis_smaller: \"on sinun omaa mittaasi <u>pienempi</u>\",\r\n\t\t\t\toverlaps_you: \"ylitt mittasi\",\r\n\t\t\t\tarm_sleeve_straight: \"kun ktesi ja tuotteen hiha on <u>suoraan alaspin</u>\",\r\n\t\t\t\tsm_considers_fit: \"SizeMe:n mielest tm sopivuus on\",\r\n\t\t\t\toverall_fit: \"Sopivuus\",\t\t\t\t\r\n\t\t\t\toverall_fit_for_size: \"Sopivuus <b>koolle\"\r\n\t\t\t},\r\n\t\t\tSPLASH: {\r\n\t\t\t\tdetailed_text: \"Ota <b>muutama mitta</b> itsestsi ja ne miten tm tuote <b>sopisi sinulle</b>.<br />Luo oma <b>SizeMe</b>-tunnus ja lopeta arvailu!\",\r\n\t\t\t\tbtn_sign_up_title: \"Liityn mukaan\",\r\n\t\t\t\tbtn_sign_up_label: \"Jep, haluan luoda oman tunnuksen\",\r\n\t\t\t\tbtn_log_in_title: \"Kirjaudu\",\r\n\t\t\t\tbtn_log_in_label: \"Minulla on jo oma tunnus\",\r\n\t\t\t\tbtn_no_thanks_title: \"Ei kiitos\",\r\n\t\t\t\tbtn_no_thanks_label: \"Ehk myhemmin\",\r\n\t\t\t\tproduct_page_splashes: [\"Haluatko apua oikean koon valitsemisessa? Kokeile\"],\r\n\t\t\t\tproduct_page_splash_title: \"SizeMe-palvelu kertoo miten tm tuote sopii juuri _sinulle_\"\r\n\t\t\t}\r\n        }\r\n    );\r\n\r\n})(window);\n// SizeMe UI JS v1.0\r\n// based on SizeMe Item Types 2015-10-01\r\n// (c) SizeMe Inc.\r\n// www.sizeme.com\r\n// License undecided\r\n/* jshint browser:true, jquery:true */\r\n/* globals sizeme_product: false, sizeme_options: false, sizeme_UI_options: false, Opentip: false, SizeMe: false */\r\n\r\n(function($) {\r\n    \"use strict\";\r\n\r\n\tvar i18n = {};\r\n\r\n    var FIT_RANGES = {\r\n        1: {label: \"too_small\", arrowColor: \"#999999\"},\r\n        940: {label: \"too_small\", arrowColor: \"#BB5555\"},\r\n        1000: {label: \"slim\", arrowColor: \"#457A4C\"},\r\n        1055: {label: \"regular\", arrowColor: \"#42AE49\"},\r\n        1110: {label: \"loose\", arrowColor: \"#87B98E\"},\r\n        1165: {label: \"too_big\", arrowColor: \"#BB5555\"},\r\n        1225: {label: \"too_big\", arrowColor: \"#BB5555\"}\r\n    };\r\n\t\r\n    var FIT_RANGES_LESS_IMPORTANCE = {\r\n        1: {label: \"too_small\", arrowColor: \"#999999\"},\r\n        940: {label: \"too_small\", arrowColor: \"#BB5555\"},\r\n        1000: {label: \"slim\", arrowColor: \"#457A4C\"},\r\n        1055: {label: \"regular\", arrowColor: \"#42AE49\"},\r\n        1110: {label: \"loose\", arrowColor: \"#87B98E\"}\r\n    };\r\n\r\n    var sliderPosXMin = 940;\r\n    var sliderPosXMax = 1225;\r\n\tvar sliderScale = 100 / (sliderPosXMax - sliderPosXMin);\r\n\r\n    var FIT_ORDER = [\r\n        \"chest\",\r\n        \"waist\",\r\n        \"underbust\",\r\n        \"pant_waist\",\r\n        \"hips\",\r\n        \"inseam\",\r\n        \"outseam\",\r\n        \"thigh_width\",\r\n        \"knee_width\",\r\n        \"calf_width\",\r\n        \"pant_sleeve_width\",\r\n        \"neck_opening_width\",\r\n        \"shoulder_width\",\r\n        \"sleeve_top_width\",\r\n        \"sleeve_top_opening\",\r\n        \"sleeve\",\r\n        \"wrist_width\",\r\n        \"front_height\",\r\n        \"shoe_inside_length\",\r\n        \"shoe_inside_width\",\r\n        \"hat_width\",\r\n        \"hood_height\"\r\n    ];\r\n\r\n    var PINCHED_FITS = [\r\n        \"chest\",\r\n        \"waist\",\r\n        \"underbust\",\r\n        \"pant_waist\",\r\n        \"hips\",\r\n        \"thigh_width\",\r\n        \"knee_width\",\r\n        \"calf_width\",\r\n        \"pant_sleeve_width\",\r\n        \"neck_opening_width\",\r\n        \"sleeve_top_width\",\r\n        \"sleeve_top_opening\",\r\n        \"wrist_width\",\r\n        \"hat_width\"\r\n    ];\r\n\r\n    var LONG_FITS = [\r\n        \"inseam\",\r\n        \"outseam\",\r\n        \"sleeve\",\r\n        \"front_height\",\r\n\t\t\"shoe_inside_length\"\r\n    ];\r\n\r\n    var OPTIMAL_FIT = 1070;\r\n\r\n    var realCanvasWidth = 350;\r\n    var realCanvasHeight = 480;\r\n    var padding = 0.07;\r\n\r\n    var drawColor = '#777777';\r\n    var fillColor = '#BBBBBB';\r\n    var arrowColor;\r\n    var arrowColorGreen = '#42AE49';\r\n    var arrowColorBlack = '#000000';\r\n    var arrowColorInfo = '#666666';\r\n\r\n    var itemLineWidth = 1;\r\n    var arrowLineWidth = 2;\r\n    var arrowEndRadius = 4;\r\n    var arrowNumberRadius = 10;\r\n    var arrowNumberFont = \"10px sans-serif\";\r\n    var arrowNumberHighlightFont = \"bold 14px sans-serif\";\r\n    var arrowLift = 30;\r\n    var arcRadius = 10;\r\n\r\n    var fadeLength = 400;\r\n\r\n    var item_drawing = {};\r\n    var measurement_arrows = {};\r\n\r\n    var sizeKeys = [];\r\n\r\n    var recommendedId;\r\n    var recommendedLabel = \"none\";\r\n\r\n    var selectedProfile;\r\n    var linkToSelectedProfile;\r\n\r\n    var accuracyThreshold = 0.01;\r\n\r\n    var cookieLifetime = 90;\r\n\r\n    var itemName = \"\";\r\n\r\n    var sizeme_local_options = {\r\n        fitAreaSlider: true,\r\n        writeMessages: true,\r\n        writeOverlaps: true,\r\n\t\tfirstRecommendation: true\r\n    };\r\n\r\n    function sizeText(txt) {\r\n        var retStr = txt;\r\n        retStr = retStr.split(\" -\")[0];\r\n        retStr = retStr.split(\" +\")[0];\r\n        return retStr;\r\n    }\r\n\r\n    function getFit(fitValue, importance) {\r\n        var returnFit, singleFit;\r\n\t\tvar ranges;\r\n\t\tranges = FIT_RANGES_LESS_IMPORTANCE;\r\n\t\tif (importance == 1) ranges = FIT_RANGES;\r\n        for (singleFit in ranges) {\r\n            if (ranges.hasOwnProperty(singleFit)) {\r\n                if (fitValue < singleFit) {\r\n                    if (returnFit) {\r\n                        return returnFit;\r\n                    }\r\n                    return ranges[singleFit];\r\n                }\r\n                returnFit = ranges[singleFit];\r\n            }\r\n        }\r\n        return returnFit;\r\n    }\r\n\r\n    function addIds(parentElement) {\r\n        // add ids to select for easy handling\r\n        $(parentElement + \" option\").each(function () {\r\n            var myVal = $(this).val();\r\n            var myText = $(this).text();\r\n            $(this).addClass(\"sm-selectable element_for_\" + myVal);\r\n            this.id = (myVal ? \"input_\" + myVal : \"choose\");\r\n            if (myVal) {\r\n                if (sizeme_product.item.measurements[myVal]) {\r\n                    sizeKeys.push({key: myVal, sizeLabel: myText});\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n\tfunction getItemTypeArr() {\r\n\t\tvar itemTypeStr = sizeme_product.item.itemType.toString();\r\n\t\tvar itemTypeArr = [0,0,0,0,0,0,0];\r\n\t\tvar separator = '';\r\n\t\tif (itemTypeStr.indexOf('.') > -1) separator = '.';\r\n\t\tvar itemTypeSplitted = itemTypeStr.split(separator, 7);\r\n\t\tfor(var i=0; i<itemTypeSplitted.length;i++) itemTypeArr[i] = +itemTypeSplitted[i];\r\n\t\treturn itemTypeArr;\r\n\t}\r\n\t\r\n    function isInside() {\r\n        var itemTypeArr = getItemTypeArr();\r\n        return ( (itemTypeArr[0] === 3) || (itemTypeArr[0] === 4) );\r\n    }\r\n\r\n    function loadArrows(isSizeGuide) {\r\n        var $i, $x;\r\n\t\tvar itemTypeArr = getItemTypeArr();\r\n\r\n        // arrows first\r\n        arrowColor = arrowColorGreen;\r\n        var arcStyle = \"arc\";\r\n\r\n        if (isSizeGuide) {\r\n            arrowColor = arrowColorBlack;\r\n            arcStyle = \"line\"; // size guide shows flat measurements (except neck opening)\r\n        }\r\n\r\n        measurement_arrows.chest = { mirror: false, coords: [{X: -250,Y: 399},{X: 250,Y: 399}], style: arcStyle, lift: false, color: arrowColor };\r\n        measurement_arrows.waist = { mirror: false, coords: [{X: -250,Y: 635},{X: 250,Y: 635}], style: arcStyle, lift: false, color: arrowColor };\r\n        measurement_arrows.front_height = { mirror: false, coords: [{X: -174,Y: 0},{X: -174,Y: 978}], style: \"line\", lift: false, color: arrowColor };\r\n        measurement_arrows.neck_opening_width = {\r\n            mirror: false,\r\n            coords: [{X: 0,Y: 47}, {X: 174,Y: 0, cp1X: 65, cp1Y: 45, cp2X: 140, cp2Y: 23}, {X: 0,Y: 100, cp1X: 150, cp1Y: 46, cp2X: 50, cp2Y: 92},\r\n                {X: -174,Y: 0, cp1X: -50, cp1Y: 92, cp2X: -150, cp2Y: 46}, {X: 0,Y: 47, cp1X: -140, cp1Y: 23, cp2X: -65, cp2Y: 45}],\r\n            style: \"line\",\r\n            lift: true,\r\n            color: arrowColor};\r\n\r\n        measurement_arrows.hood_height = { mirror: false, coords: [{X: 195,Y: -5},{X: 195,Y: -390}], style: \"line\", lift: false, color: arrowColor };\r\n        measurement_arrows.shoulder_width = { mirror: false, coords: [{X: -329,Y: 42},{X: -164,Y: -7}], style: \"line\", lift: true, color: arrowColor };\r\n\r\n        measurement_arrows.pant_waist = { mirror: false, coords: [{X: -232,Y: 0},{X: 222,Y: 0}], style: arcStyle, lift: true, color: arrowColor };\r\n        measurement_arrows.hips = { mirror: false, coords: [{X: -261,Y: 171}, {X: 263,Y: 171}], style: arcStyle, lift: false, color: arrowColor };\r\n        measurement_arrows.outseam = { mirror: false, coords: [{X: 222,Y: 0},{X: 263,Y: 171},{X: 302,Y: 1071}], style: \"line\", lift: true, color: arrowColor };\r\n        measurement_arrows.inseam = { mirror: false, coords: [{X: 5,Y: 297},{X: 151, Y: 1084}], style: \"line\", lift: false, color: arrowColor };\r\n        measurement_arrows.thigh_width = { mirror: false, coords: [{X: -266,Y: 274},{X: -17,Y: 297}], style: arcStyle, lift: false, color: arrowColor };\r\n        measurement_arrows.knee_width = { mirror: false, coords: [{X: -286,Y: 727},{X: -93,Y: 744}], style: arcStyle, lift: false, color: arrowColor };\r\n        measurement_arrows.pant_sleeve_width = { mirror: false, coords: [{X: -301,Y: 1071},{X: -152,Y: 1084}], style: arcStyle, lift: false, color: arrowColor };\r\n\r\n        measurement_arrows.shoe_inside_length = { mirror: false, coords: [{X: 169,Y: 984},{X: 132,Y: 18}], style: \"line\", lift: false, color: arrowColor };\r\n\r\n        measurement_arrows.hat_width = {\r\n            mirror: false,\r\n            coords: [{X: 534,Y: 238},\r\n                {X: 539,Y: 265, cp1X: 559, cp1Y: 236, cp2X: 567, cp2Y: 252},\r\n                {X: 70,Y: 262, cp1X: 352, cp1Y: 353, cp2X: 223, cp2Y: 351},\r\n                {X: 77,Y: 242, cp1X: 38, cp1Y: 241, cp2X: 60, cp2Y: 234}],\r\n            midCircle: {X: 300, Y: 325},\r\n            style: \"line\",\r\n            lift: false,\r\n            color: arrowColor };\r\n\r\n        item_drawing.mirror = true;\r\n        item_drawing.coords = [];\r\n        item_drawing.accents = [];\r\n        // load item drawing\r\n        switch (itemTypeArr[0]) {\r\n\r\n            case 1:\t// shirts/coats\r\n                i18n.MEASUREMENT.hips = i18n.MEASUREMENT.hem;\r\n                i18n.MEASUREMENT.pant_waist = i18n.MEASUREMENT.hem;\r\n\r\n                switch (itemTypeArr[1]) { // collar\r\n                    case 2:\t// tight (turnover)\r\n                        item_drawing.coords.push({X: 0,Y: -60},{X: 119,Y: -48, cp1X: 68, cp1Y: -60, cp2X: 106, cp2Y: -57}, {X: 128,Y: 0});\r\n                        item_drawing.accents.push({type: \"area\", coords: [\t{X: 0,Y: -47},\r\n                            {X: 100,Y: -35, cp1X: 64, cp1Y: -48, cp2X: 105, cp2Y: -47},\r\n                            {X: -5,Y: 59, cp1X: 66, cp1Y: 8, cp2X: 6, cp2Y: 40},\r\n                            {X: -104,Y: -34, cp1X: -25, cp1Y: 32, cp2X: -93, cp2Y: -12},\r\n                            {X: 0,Y: -46, cp1X: -117, cp1Y: -48, cp2X: -52, cp2Y: -48}\r\n                        ], noMirror: true});\r\n                        item_drawing.accents.push({type: \"line\", coords:[\t{X: 129,Y: 0},\r\n                            {X: 136,Y: 26, cp1X: 132, cp1Y: 14, cp2X: 133, cp2Y: 18},\r\n                            {X: 78,Y: 125, cp1X: 123, cp1Y: 63, cp2X: 100, cp2Y: 95},\r\n                            {X: 37,Y: 78, cp1X: 60, cp1Y: 106, cp2X: 51, cp2Y: 101},\r\n                            {X: -12,Y: 111, cp1X: 24, cp1Y: 8, cp2X: -32, cp2Y: 66}\r\n                        ], noMirror: true});\t// non mirrored turnover collar right\r\n                        item_drawing.accents.push({type: \"line\", coords:[\t{X: -129,Y: 0},\r\n                            {X: -136,Y: 26, cp1X: -132, cp1Y: 14, cp2X: -133, cp2Y: 18},\r\n                            {X: -90,Y: 127, cp1X: -127, cp1Y: 68, cp2X: -106, cp2Y: 110},\r\n                            {X: -9,Y: 59, cp1X: -33, cp1Y: 88, cp2X: -61, cp2Y: 25}\r\n                        ], noMirror: true});\t// non mirrored turnover collar left\r\n                        item_drawing.accents.push({type: \"circle\", coords: [{X: 0,Y: 100, R: 5}]});\r\n                        measurement_arrows.neck_opening_width = {\r\n                            mirror: false,\r\n                            coords: [{X: 0,Y: -47}, {X: 100,Y: -35, cp1X: 64, cp1Y: -48, cp2X: 105, cp2Y: -47},\r\n                                {X: -5,Y: 59, cp1X: 66, cp1Y: 8, cp2X: 6, cp2Y: 40}, {X: -104,Y: -34, cp1X: -25, cp1Y: 32, cp2X: -93, cp2Y: -12},\r\n                                {X: 0,Y: -46, cp1X: -117, cp1Y: -48, cp2X: -52, cp2Y: -48}],\r\n                            style: \"line\",\r\n                            lift: false,\r\n                            midCircle: {X: 0, Y: -47},\r\n                            color: arrowColor};\r\n                        measurement_arrows.shoulder_width = { mirror: false, coords: [{X: -329,Y: 49},{X: -129,Y: -5}], style: \"line\", lift: true, color: arrowColor };\r\n                        measurement_arrows.front_height = { mirror: false, coords: [{X: -167,Y: -4},{X: -167,Y: 978}], style: \"line\", lift: false, color: arrowColor };\r\n\r\n                        break;\r\n                    case 3:\t// hood\r\n                        item_drawing.coords.push({X: 0,Y: -390},{X: 185,Y: 6, cp1X: 180, cp1Y: -400, cp2X: 160, cp2Y: -20});\r\n                        item_drawing.accents.push({type: \"line\", coords: [{X: 185,Y: 6}, {X: 0,Y: 123, cp1X: 140, cp1Y: 70, cp2X: 70, cp2Y: 100}]});\t// basic round collar line\r\n                        item_drawing.accents.push({type: \"area\", coords: [{X: 0,Y: -320}, {X: 144,Y: 0, cp1X: 150, cp1Y: -320, cp2X: 140, cp2Y: -20}, {X: 0,Y: 100, cp1X: 140, cp1Y: 46, cp2X: 40, cp2Y: 92}]}); // hood area\r\n                        measurement_arrows.shoulder_width = { mirror: false, coords: [{X: -329,Y: 42},{X: -174,Y: -7}], style: \"line\", lift: true, color: arrowColor };\r\n                        break;\r\n                    case 5:\t// open high round\r\n                        item_drawing.coords.push({X: 0,Y: 90},{X: 189,Y: 0});\r\n                        item_drawing.accents.push({type: \"line\", coords: [{X: 210,Y: 6}, {X: 0,Y: 123, cp1X: 165, cp1Y: 70, cp2X: 100, cp2Y: 123}]});\t// open round collar line\r\n                        item_drawing.accents.push({type: \"area\", coords: [{X: 0,Y: 49}, {X: 189,Y: 0, cp1X: 100, cp1Y: 47, cp2X: 155, cp2Y: 23}, {X: 0,Y: 102, cp1X: 165, cp1Y: 46, cp2X: 95, cp2Y: 102}]}); // open collar area\r\n                        break;\r\n                    case 6:\t// open low round\r\n                        item_drawing.coords.push({X: 0,Y: 180},{X: 164,Y: 0});\r\n                        item_drawing.accents.push({type: \"line\", coords: [{X: 181,Y: 5}, {X: 0,Y: 196, cp1X: 146, cp1Y: 196, cp2X: 50, cp2Y: 196}]});\t// collar line\r\n                        item_drawing.accents.push({type: \"area\", coords: [{X: 0,Y: 47}, {X: 164,Y: 0, cp1X: 55, cp1Y: 45, cp2X: 130, cp2Y: 23}, {X: 0,Y: 180, cp1X: 130, cp1Y: 180, cp2X: 45, cp2Y: 180}]}); // basic area\r\n                        break;\r\n                    case 7:\t// v-style high\r\n                        item_drawing.coords.push({X: 0,Y: 90},{X: 189,Y: 0});\r\n                        item_drawing.accents.push({type: \"line\", coords: [{X: 210,Y: 6}, {X: 0,Y: 123, cp1X: 165, cp1Y: 70, cp2X: 80, cp2Y: 100}]});\t// open round collar line\r\n                        item_drawing.accents.push({type: \"area\", coords: [{X: 0,Y: 47}, {X: 189,Y: 0, cp1X: 80, cp1Y: 45, cp2X: 155, cp2Y: 23}, {X: 0,Y: 100, cp1X: 165, cp1Y: 46, cp2X: 65, cp2Y: 92}]}); // open collar area\r\n                        break;\r\n                    case 8:\t// v-style low\r\n                        item_drawing.coords.push({X: 0,Y: 90},{X: 189,Y: 0});\r\n                        item_drawing.accents.push({type: \"line\", coords: [{X: 210,Y: 6}, {X: 0,Y: 123, cp1X: 165, cp1Y: 70, cp2X: 80, cp2Y: 100}]});\t// open round collar line\r\n                        item_drawing.accents.push({type: \"area\", coords: [{X: 0,Y: 47}, {X: 189,Y: 0, cp1X: 80, cp1Y: 45, cp2X: 155, cp2Y: 23}, {X: 0,Y: 100, cp1X: 165, cp1Y: 46, cp2X: 65, cp2Y: 92}]}); // open collar area\r\n                        break;\r\n                    default:\t// elastic round\r\n                        item_drawing.coords.push({X: 0,Y: 90},{X: 164,Y: 0});\r\n                        item_drawing.accents.push({type: \"line\", coords: [{X: 185,Y: 6}, {X: 0,Y: 110, cp1X: 140, cp1Y: 70, cp2X: 70, cp2Y: 108}]});\t// basic round collar line\r\n                        item_drawing.accents.push({type: \"area\", coords: [{X: 0,Y: 47}, {X: 164,Y: 0, cp1X: 55, cp1Y: 45, cp2X: 130, cp2Y: 23}, {X: 0,Y: 90, cp1X: 140, cp1Y: 46, cp2X: 55, cp2Y: 90}]}); // basic area\r\n                        break;\r\n                }\r\n\r\n                switch (itemTypeArr[3]) { // sleeve length\r\n                    case 0:\t// tank top, string top or poncho\r\n                    case 1:\t// very short (vest)\r\n                        item_drawing.coords.push({X: 289,Y: 34});\r\n                        item_drawing.coords.push({X: 250,Y: 399, cp1X: 285, cp1Y: 44, cp2X: 220, cp2Y: 389});\r\n                        measurement_arrows.shoulder_width = { mirror: false, coords: [{X: -299,Y: 32},{X: -164,Y: -7}], style: \"line\", lift: true, color: arrowColor };\r\n\t\t\t\t\t\tmeasurement_arrows.sleeve_top_width = { mirror: false, coords: [{X: 250,Y: 399},{X: 289,Y: 34}], style: arcStyle, lift: false, color: arrowColor };\r\n\r\n                        if (itemTypeArr[4] !== 0) {\r\n\t\t\t\t\t\t\t// is it you, poncho?\r\n                            item_drawing.coords.push({X: 250,Y: 399, cp1X: 328, cp1Y: 44, cp2X: 250, cp2Y: 260});\r\n                            FIT_ORDER.splice(13, 1);  // remove sleeve top\r\n                            measurement_arrows.sleeve_top_width = false;\r\n                        }\r\n                        break;\r\n                    case 2:  // short\r\n                    case 3:  // short-medium (normal t-shirt)\r\n                        item_drawing.coords.push({X: 329,Y: 44});\r\n                        item_drawing.coords.push({X: 482,Y: 460},{X: 324,Y: 529});\r\n                        item_drawing.coords.push({X: 250,Y: 399});\r\n\r\n                        measurement_arrows.sleeve_top_width = { mirror: false, coords: [{X: 250,Y: 399},{X: 430,Y: 322}], style: arcStyle, lift: false, color: arrowColor };\r\n                        measurement_arrows.wrist_width = { mirror: false, coords: [{X: 324,Y: 529},{X: 482,Y: 460}], style: arcStyle, lift: false, color: arrowColor };\r\n\t\t\t\t\t\t\r\n                        i18n.MEASUREMENT.wrist_width = i18n.MEASUREMENT.sleeve_opening;\r\n\r\n\t\t\t\t\t\tswitch (itemTypeArr[2]) { // shoulder types\r\n\t\t\t\t\t\t\tcase 3:\t// dropped\r\n\t\t\t\t\t\t\t\titem_drawing.accents.push({type: \"line\", coords: [{X: 250,Y: 399}, {X: 381,Y: 184}]});\r\n\t\t\t\t\t\t\t\tmeasurement_arrows.sleeve = { mirror: false, coords: [{X: 174,Y: -16}, {X: 329,Y: 27},{X: 482,Y: 460}], style: \"line\", lift: true, midCircle: {X: 406, Y: 243}, color: arrowColor };\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 2:\t// raglan line\r\n\t\t\t\t\t\t\t\titem_drawing.accents.push({type: \"line\", coords: [{X: 250,Y: 399}, {X: 185,Y: 6, cp1X: 220, cp1Y: 320, cp2X: 185, cp2Y: 6}]});\r\n\t\t\t\t\t\t\t\tmeasurement_arrows.sleeve = { mirror: false, coords: [{X: 174,Y: -16}, {X: 329,Y: 27},{X: 482,Y: 460}], style: \"line\", lift: true, midCircle: {X: 406, Y: 243}, color: arrowColor };\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 1:\t// normal shoulder line\r\n\t\t\t\t\t\t\t\tmeasurement_arrows.sleeve = { mirror: false, coords: [{X: 329,Y: 44},{X: 482,Y: 460}], style: \"line\", lift: true, color: arrowColor };\r\n\t\t\t\t\t\t\t\titem_drawing.accents.push({type: \"line\", coords: [{X: 250,Y: 399}, {X: 329,Y: 44, cp1X: 250, cp1Y: 250, cp2X: 300, cp2Y: 70}]});\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n                        break;\r\n                    case 4:  // medium\r\n                    case 5:  // semi-long\r\n                        item_drawing.coords.push({X: 329,Y: 44});\r\n                        item_drawing.coords.push({X: 527,Y: 719},{X: 389,Y: 769});\r\n                        item_drawing.coords.push({X: 250,Y: 399});\r\n\r\n                        measurement_arrows.sleeve_top_width = { mirror: false, coords: [{X: 250,Y: 399},{X: 419,Y: 340}], style: arcStyle, lift: false, color: arrowColor };\r\n                        measurement_arrows.wrist_width = { mirror: false, coords: [{X: 389,Y: 769},{X: 527,Y: 719}], style: arcStyle, lift: false, color: arrowColor };\r\n\t\t\t\t\t\t\r\n                        i18n.MEASUREMENT.wrist_width = i18n.MEASUREMENT.sleeve_opening;\r\n\r\n\t\t\t\t\t\tswitch (itemTypeArr[2]) { // shoulder types\r\n\t\t\t\t\t\t\tcase 3:\t// dropped\r\n\t\t\t\t\t\t\t\titem_drawing.accents.push({type: \"line\", coords: [{X: 250,Y: 399}, {X: 369,Y: 196}]});\r\n\t\t\t\t\t\t\t\tmeasurement_arrows.sleeve = { mirror: false, coords: [{X: 174,Y: -16}, {X: 329,Y: 27},{X: 527,Y: 719}], style: \"line\", lift: true, midCircle: {X: 450, Y: 444}, color: arrowColor };\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 2:\t// raglan line\r\n\t\t\t\t\t\t\t\titem_drawing.accents.push({type: \"line\", coords: [{X: 250,Y: 399}, {X: 185,Y: 6, cp1X: 220, cp1Y: 320, cp2X: 185, cp2Y: 6}]});\r\n\t\t\t\t\t\t\t\tmeasurement_arrows.sleeve = { mirror: false, coords: [{X: 174,Y: -16}, {X: 329,Y: 27},{X: 527,Y: 719}], style: \"line\", lift: true, midCircle: {X: 450, Y: 444}, color: arrowColor };\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 1:\t// normal shoulder line\r\n\t\t\t\t\t\t\t\tmeasurement_arrows.sleeve = { mirror: false, coords: [{X: 329,Y: 44},{X: 527,Y: 719}], style: \"line\", lift: true, color: arrowColor };\r\n\t\t\t\t\t\t\t\titem_drawing.accents.push({type: \"line\", coords: [{X: 250,Y: 399}, {X: 329,Y: 44, cp1X: 250, cp1Y: 250, cp2X: 300, cp2Y: 70}]});\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n                    case 6:  // long\r\n                    case 7:  // very long\r\n                    case 8:  // extra long\r\n                        item_drawing.coords.push({X: 329,Y: 44});\r\n\t\t\t\t\t\tmeasurement_arrows.sleeve_top_width = { mirror: false, coords: [{X: 250,Y: 399},{X: 410,Y: 348}], style: arcStyle, lift: false, color: arrowColor };\r\n\r\n                        if (itemTypeArr[4] === 1) {\t// elastic\r\n                            item_drawing.coords.push({X: 556,Y: 902},{X: 547,Y: 930}, {X: 557,Y: 978},{X: 463,Y: 998},{X: 449,Y: 951},{X: 430,Y: 934});\r\n                            item_drawing.accents.push({type: \"line\", coords: [{X: 465,Y: 944}, {X: 476,Y: 996}]},\r\n                                {type: \"line\", coords: [{X: 476,Y: 941}, {X: 487,Y: 993}]},\r\n                                {type: \"line\", coords: [{X: 487,Y: 938}, {X: 498,Y: 990}]},\r\n                                {type: \"line\", coords: [{X: 498,Y: 935}, {X: 509,Y: 987}]},\r\n                                {type: \"line\", coords: [{X: 509,Y: 932}, {X: 520,Y: 984}]},\r\n                                {type: \"line\", coords: [{X: 520,Y: 929}, {X: 531,Y: 981}]},\r\n                                {type: \"line\", coords: [{X: 531,Y: 926}, {X: 542,Y: 978}]});\r\n                            item_drawing.coords.push({X: 250,Y: 399});\r\n                            measurement_arrows.wrist_width = { mirror: false, coords: [{X: 430,Y: 934}, {X: 556,Y: 902}], style: arcStyle, lift: false, color: arrowColor };\r\n                        } else {\r\n                            item_drawing.coords.push({X: 571,Y: 978},{X: 454,Y: 1009});\r\n                            item_drawing.coords.push({X: 250,Y: 399});\r\n\t\t\t\t\t\t\tmeasurement_arrows.wrist_width = { mirror: false, coords: [{X: 571,Y: 978},{X: 454,Y: 1009}], style: arcStyle, lift: false, color: arrowColor };\r\n                        }\r\n\r\n\t\t\t\t\t\tswitch (itemTypeArr[2]) { // shoulder types\r\n\t\t\t\t\t\t\tcase 3:\t// dropped\r\n\t\t\t\t\t\t\t\titem_drawing.accents.push({type: \"line\", coords: [{X: 250,Y: 399}, {X: 369,Y: 196}]});\r\n\t\t\t\t\t\t\t\tmeasurement_arrows.sleeve = { mirror: false, coords: [{X: 174,Y: -16}, {X: 329,Y: 27},{X: 571,Y: 978}], style: \"line\", lift: true, midCircle: {X: 437, Y: 444}, color: arrowColor };\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 2:\t// raglan line\r\n\t\t\t\t\t\t\t\titem_drawing.accents.push({type: \"line\", coords: [{X: 250,Y: 399}, {X: 185,Y: 6, cp1X: 220, cp1Y: 320, cp2X: 185, cp2Y: 6}]});\r\n\t\t\t\t\t\t\t\tmeasurement_arrows.sleeve = { mirror: false, coords: [{X: 174,Y: -16}, {X: 329,Y: 27},{X: 571,Y: 978}], style: \"line\", lift: true, midCircle: {X: 437, Y: 444}, color: arrowColor };\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 1:\t// normal shoulder line\r\n\t\t\t\t\t\t\t\tmeasurement_arrows.sleeve = { mirror: false, coords: [{X: 329,Y: 44},{X: 569,Y: 975}], style: \"line\", lift: true, color: arrowColor };\r\n\t\t\t\t\t\t\t\titem_drawing.accents.push({type: \"line\", coords: [{X: 250,Y: 399}, {X: 329,Y: 44, cp1X: 250, cp1Y: 250, cp2X: 300, cp2Y: 70}]});\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n                        break;\r\n                }\r\n\r\n                switch (itemTypeArr[5]) { // waistband\r\n                    case 0:\t// poncho dude\r\n                        item_drawing.coords.push({X: 550,Y: 750, cp1X: 450, cp1Y: 70, cp2X: 450, cp2Y: 550});\r\n                        item_drawing.coords.push({X: 0,Y: 1038, cp1X: 450, cp1Y: 800, cp2X: 400, cp2Y: 1038});\r\n                        measurement_arrows.front_height = { mirror: false, coords: [{X: -174,Y: 5},{X: -174,Y: 1018}], style: \"line\", lift: false, color: arrowColor };\r\n                        measurement_arrows.sleeve = { mirror: false, coords: [{X: 174,Y: 0}, {X: 394,Y: 59},{X: 550,Y: 750}], style: \"line\", lift: true, midCircle: {X: 480, Y: 444}, color: arrowColor };\r\n                        break;\r\n                    case 3:\t// pant waist\r\n                        if (itemTypeArr[6] === 1) {\t// elastic\r\n                            item_drawing.coords.push({X: 250,Y: 908, cp1X: 247, cp1Y: 402, cp2X: 247, cp2Y: 858},{X: 230,Y: 978},{X: 0,Y: 978});\r\n                            for ($i = 0; $i<15; $i++) {\r\n                                $x = Math.round(($i+0.5)*(230/15));\r\n                                item_drawing.accents.push({type: \"line\", coords: [{X: $x,Y: 918}, {X: $x,Y: 978}]});\r\n                            }\r\n                            measurement_arrows.pant_waist = { mirror: false, coords: [{X: -250,Y: 908}, {X: 250,Y: 908}], style: arcStyle, lift: false, color: arrowColor };\r\n                        } else {\r\n                            item_drawing.coords.push({X: 250,Y: 978, cp1X: 245, cp1Y: 402, cp2X: 245, cp2Y: 928},{X: 0,Y: 978});\r\n                            measurement_arrows.pant_waist = { mirror: false, coords: [{X: -250,Y: 978}, {X: 250,Y: 978}], style: arcStyle, lift: false, color: arrowColor };\r\n                        }\r\n                        break;\r\n                    case 4:\t// hips\r\n                    /* falls through */\r\n                    case 5:\t// half-way-thigh\r\n                    /* falls through */\r\n                    default:\r\n                        var $base_y = 978;\r\n                        if (itemTypeArr[5] === 5) {\r\n                            $base_y = 1038;\r\n                        }\r\n                        if (itemTypeArr[6] === 1) {\t// elastic\r\n                            item_drawing.coords.push({X: 250,Y: $base_y, cp1X: 247, cp1Y: 402, cp2X: 247, cp2Y: 908},{X: 230,Y: ($base_y+60)},{X: 0,Y: ($base_y+60)});\r\n                            for ($i = 0; $i<15; $i++) {\r\n                                $x = Math.round(($i+0.5)*(230/15));\r\n                                item_drawing.accents.push({type: \"line\", coords: [{X: $x,Y: ($base_y+10)}, {X: $x,Y: ($base_y+60)}]});\r\n                            }\r\n                            measurement_arrows.front_height.coords[1].Y = ($base_y+60);\r\n                            measurement_arrows.hips = { mirror: false, coords: [{X: -250,Y: $base_y}, {X: 250,Y: $base_y}], style: arcStyle, lift: false, color: arrowColor };\r\n                        } else {\r\n                            item_drawing.coords.push({X: 250,Y: ($base_y+60), cp1X: 245, cp1Y: 402, cp2X: 245, cp2Y: $base_y},{X: 0,Y: ($base_y+60)});\r\n                            measurement_arrows.front_height.coords[1].Y = ($base_y+60);\r\n                            measurement_arrows.hips = { mirror: false, coords: [{X: -250,Y: ($base_y+60)}, {X: 250,Y: ($base_y+60)}], style: arcStyle, lift: false, color: arrowColor };\r\n                        }\r\n                        break;\r\n                }\r\n\r\n                break;\t// case 1 shirts/coats\r\n\r\n            case 2:\t// trousers/shorts\r\n                item_drawing.mirror = false; // for accents mainly\r\n                item_drawing.coords.push({X: -232,Y: 0},{X: 222,Y: 0, cp1X: -100, cp1Y: 10, cp2X: 90, cp2Y: 10},{X: 263,Y: 171});\r\n\r\n                switch (itemTypeArr[3]) { // sleeve\r\n                    case 1:\t// very short\r\n                    case 2:\t// short\r\n                    case 3:\t// short-medium\r\n                        item_drawing.coords.push({X: 278,Y: 449},{X: 38, Y: 474});\r\n                        break;\r\n                    case 4:\t// medium\r\n                        item_drawing.coords.push({X: 291,Y: 626},{X: 71, Y: 651});\r\n                        break;\r\n                    case 5:  // semi-long\r\n                    case 6:  // long\r\n                        item_drawing.coords.push({X: 302,Y: 1071},{X: 151, Y: 1084});\r\n                        break;\r\n                }\r\n\r\n                item_drawing.coords.push({X: 5,Y: 297},{X: -17,Y: 297});\r\n\r\n                switch (itemTypeArr[3]) { // sleeve again as not mirror\r\n                    case 1:\t// very short\r\n                    case 2:\t// short\r\n                    case 3:\t// short-medium\r\n                        item_drawing.coords.push({X: -38, Y: 474}, {X: -278,Y: 449});\r\n                        measurement_arrows.outseam = { mirror: false, coords: [{X: 222,Y: 0},{X: 263,Y: 171},{X: 278,Y: 449}], style: \"line\", lift: true, color: arrowColor };\r\n                        measurement_arrows.knee_width = { mirror: false, coords: [{X: -278,Y: 449},{X: -38,Y: 474}], style: arcStyle, lift: false, color: arrowColor };\r\n                        break;\r\n                    case 4:\t// medium\r\n                        item_drawing.coords.push({X: -71,Y: 651},{X: -291,Y: 626});\r\n                        measurement_arrows.outseam = { mirror: false, coords: [{X: 222,Y: 0},{X: 263,Y: 171},{X: 291,Y: 626}], style: \"line\", lift: true, color: arrowColor };\r\n                        measurement_arrows.knee_width = { mirror: false, coords: [{X: -291,Y: 626},{X: -71,Y: 651}], style: arcStyle, lift: false, color: arrowColor };\r\n                        break;\r\n                    case 5:  // semi-long\r\n                    case 6:  // long\r\n                        item_drawing.coords.push({X: -152,Y: 1084},{X: -301,Y: 1071});\r\n                        break;\r\n                }\r\n\r\n                item_drawing.coords.push({X: -261,Y: 171});\r\n                item_drawing.accents.push(\t{type: \"area\", coords: [{X: -232,Y: 0}, {X: 222,Y: 0, cp1X: -100, cp1Y: 10, cp2X: 90, cp2Y: 10}, {X: -232,Y: 0, cp1X: 122, cp1Y: 40, cp2X: -132, cp2Y: 40}]},\r\n                    {type: \"line\", coords: [{X: -237,Y: 37}, {X: 229,Y: 37, cp1X: -137, cp1Y: 76, cp2X: 129, cp2Y: 76}]},\r\n                    {type: \"line\", coords: [{X: -14,Y: 19}, {X: -8,Y: 297, cp1X: 3, cp1Y: 114, cp2X: 0, cp2Y: 215}]},\r\n                    {type: \"line\", coords: [{X: -4,Y: 254}, {X: 29,Y: 64, cp1X: 34, cp1Y: 242, cp2X: 35, cp2Y: 188}]},\r\n                    {type: \"line\", coords: [{X: -233,Y: 160}, {X: -147,Y: 81, cp1X: -182, cp1Y: 157, cp2X: -152, cp2Y: 123}]},\r\n                    {type: \"line\", coords: [{X: 150,Y: 85}, {X: 236,Y: 164, cp1X: 158, cp1Y: 128, cp2X: 195, cp2Y: 160}]});\r\n                if (itemTypeArr[6] === '4') {\t// rope waistband\r\n                    item_drawing.accents.push(\t{type: \"line\", coords: [{X: 9,Y: 49}, {X: 8,Y: 47, cp1X: -24, cp1Y: 168, cp2X: -69, cp2Y: 84}]},\r\n                        {type: \"line\", coords: [{X: 9,Y: 50}, {X: 8,Y: 49, cp1X: 47, cp1Y: 149, cp2X: 70, cp2Y: 99}]},\r\n                        {type: \"line\", coords: [{X: 9,Y: 49}, {X: 49,Y: 49, cp1X: 27, cp1Y: 59, cp2X: 36, cp2Y: 54}]},\r\n                        {type: \"line\", coords: [{X: 9,Y: 49}, {X: 9,Y: 64, cp1X: 11, cp1Y: 54, cp2X: 11, cp2Y: 54}]});\r\n                } else {\r\n                    item_drawing.accents.push({type: \"circle\", coords: [{X: 9,Y: 48, R: 10}]});\r\n                }\r\n\r\n                break; \t// case 2 trousers\r\n\r\n            case 3:\t// shoes for my friends\r\n                item_drawing.mirror = false;\r\n                item_drawing.coords = [\t{X: 130,Y: 0},{X: 363,Y: 456, cp1X: 240, cp1Y: 8, cp2X: 345, cp2Y: 214},\r\n                    {X: 328,Y: 633, cp1X: 358, cp1Y: 532, cp2X: 328, cp2Y: 564},{X: 182,Y: 999, cp1X: 330, cp1Y: 732, cp2X: 327, cp2Y: 994},\r\n                    {X: 48,Y: 628, cp1X: 3, cp1Y: 994, cp2X: 48, cp2Y: 789},\r\n                    {X: 0,Y: 340, cp1X: 42, cp1Y: 447, cp2X: 0, cp2Y: 444},{X: 130,Y: 0, cp1X: 0, cp1Y: 114, cp2X: 72, cp2Y: 0} ];\r\n                item_drawing.accents = [{type: \"area\", coords: [{X: 164,Y: 625}, {X: 266,Y: 716, cp1X: 270, cp1Y: 632, cp2X: 276, cp2Y: 638}, {X: 168,Y: 990, cp1X: 236, cp1Y: 982, cp2X: 208, cp2Y: 987},\r\n                    {X: 69,Y: 716, cp1X: 92, cp1Y: 978, cp2X: 83, cp2Y: 852}, {X: 164,Y: 625, cp1X: 64, cp1Y: 641, cp2X: 57, cp2Y: 628}]},\r\n                    {type: \"line\", coords: [{X: 103,Y: 431}, {X: 212,Y: 430, cp1X: 112, cp1Y: 404, cp2X: 203, cp2Y: 405}]},\r\n                    {type: \"line\", coords: [{X: 115,Y: 469}, {X: 200,Y: 469, cp1X: 121, cp1Y: 447, cp2X: 188, cp2Y: 450}]},\r\n                    {type: \"line\", coords: [{X: 115,Y: 506}, {X: 200,Y: 506, cp1X: 121, cp1Y: 484, cp2X: 188, cp2Y: 484}]},\r\n                    {type: \"line\", coords: [{X: 115,Y: 555}, {X: 200,Y: 555, cp1X: 121, cp1Y: 533, cp2X: 188, cp2Y: 533}]},\r\n                    {type: \"line\", coords: [{X: 164,Y: 539}, {X: 283,Y: 541, cp1X: 242, cp1Y: 523, cp2X: 279, cp2Y: 609}, {X: 164,Y: 539, cp1X: 277, cp1Y: 492, cp2X: 209, cp2Y: 515}]},\r\n                    {type: \"line\", coords: [{X: 164,Y: 539}, {X: 45,Y: 492, cp1X: 123, cp1Y: 517, cp2X: 34, cp2Y: 532}, {X: 164,Y: 539, cp1X: 65, cp1Y: 457, cp2X: 129, cp2Y: 509}]}\r\n                ];\r\n                break;\t// case 3 shoes\r\n\r\n            case 4:\t// hats off\r\n                switch (itemTypeArr[1]) {\r\n                    case 1:\t// bucket\r\n                        item_drawing.mirror = false;\r\n                        item_drawing.coords = [\t{X: 300,Y: 0},\r\n                            {X: 522,Y: 214, cp1X: 452, cp1Y: 17, cp2X: 458, cp2Y: 61},\r\n                            {X: 599,Y: 311, cp1X: 594, cp1Y: 245, cp2X: 601, cp2Y: 283},\r\n                            {X: 293,Y: 437, cp1X: 597, cp1Y: 361, cp2X: 494, cp2Y: 433},\r\n                            {X: 0,Y: 306, cp1X: 87, cp1Y: 433, cp2X: 2, cp2Y: 355},\r\n                            {X: 92,Y: 209, cp1X: 1, cp1Y: 258, cp2X: 44, cp2Y: 227},\r\n                            {X: 300,Y: 0, cp1X: 156, cp1Y: 28, cp2X: 186, cp2Y: 16} ];\r\n                        item_drawing.accents = [\r\n                            {type: \"line\", coords: [{X: 222,Y: 48}, {X: 367,Y: 43, cp1X: 269, cp1Y: 29, cp2X: 288, cp2Y: 64}]},\r\n                            {type: \"line\", coords: [{X: 523,Y: 214}, {X: 544,Y: 280},\r\n                                {X: 63,Y: 278, cp1X: 376, cp1Y: 368, cp2X: 209, cp2Y: 373}, {X: 92,Y: 209}]} ];\r\n                        break;\r\n                }\r\n                break;\t// case 4 hats\r\n        }\r\n    }\r\n\r\n\r\n    function getSliderHtml(systemsGo) {\r\n        var sliderHtml = \"\";\r\n        var basePosX = 0;\r\n        var cellTitle = \"\";\r\n        sliderHtml += \"<div class='sizeme_slider'>\";\r\n        if (systemsGo) {\r\n            sliderHtml += \"<div class='slider_text slider_text_above'></div>\";\r\n            sliderHtml += \"<div class='slider_container'>\";\r\n            sliderHtml += \"<div class='slider_bar'>\";\r\n            sliderHtml += \"</div>\";\r\n            if (sizeme_local_options.fitAreaSlider) {\r\n                sliderHtml += \"<div class='slider_area'></div>\";\r\n            }\r\n            sliderHtml += \"<table class='slider_table'><tr>\";\r\n            for (var singleFit in FIT_RANGES) {\r\n                if (FIT_RANGES.hasOwnProperty(singleFit)) {\r\n                    if (singleFit > 1) {\r\n                        if (basePosX !== 0) {\r\n\t\t\t\t\t\t\tvar perc_width = Math.round((singleFit - basePosX) * sliderScale);\r\n                            sliderHtml += \"<td class='\" + cellTitle + \"'\";\r\n                            sliderHtml += \" style='width: \" + perc_width + \"%; min-width: \" + perc_width + \"%;'>\";\r\n                            sliderHtml += i18n.FIT_VERDICT[cellTitle];\r\n                            sliderHtml += \"</td>\";\r\n                        }\r\n                        basePosX = (+singleFit);\r\n                        cellTitle = FIT_RANGES[singleFit].label;\r\n                    }\r\n                }\r\n            }\r\n            sliderHtml += \"</tr></table>\";\r\n            sliderHtml += \"</div>\";\r\n        }\r\n        sliderHtml += \"<div class='slider_text slider_text_below'></div>\";\r\n        sliderHtml += \"<div class='slider_text slider_text_more_below'></div>\";\r\n        sliderHtml += \"</div>\";\r\n\r\n        return sliderHtml;\r\n    }\r\n\r\n    function sliderPos(fitValue, offset) {\r\n        var returnPos = (Math.min(fitValue, sliderPosXMax) - sliderPosXMin) * sliderScale;\r\n        returnPos = Math.max(0, returnPos);\r\n        returnPos += offset;   // with +offset for graphics\r\n\r\n        return returnPos;\r\n    }\r\n\r\n    function killExtraSlider() {\r\n        $(\"#slider_secondary\").remove();\r\n        return true;\r\n    }\r\n\r\n    function drawExtraSlider(fitValue) {\r\n        killExtraSlider(); // in case of hang arounds\r\n        var sliderHtml = \"<div class='slider_bar' id='slider_secondary'></div>\";\r\n        $(sliderHtml).hide().appendTo(\".sizeme_detailed_view_window .slider_container\").fadeIn(fadeLength);\r\n        var newWidth = sliderPos(fitValue, 0);\r\n        $(\"#slider_secondary\").width(newWidth+'%');\r\n        return true;\r\n    }\r\n\r\n\r\n    function writeSliderFlag(fitValue, fitLabel, thisSize, thisId) {\r\n        // first, out with the old\r\n        var sliderFlagHtml = \"<div class='sliderFlag' id='sm_sf_\"+thisSize+\"'\";\r\n        sliderFlagHtml += \" style='width: \"+sliderPos(fitValue, 0)+\"%'>\";\r\n        sliderFlagHtml += \"<a class='flagItself \"+fitLabel+\"' href='#'>\"+thisSize+\"</a>\";\r\n        sliderFlagHtml += \"</div>\";\r\n        $(\".slider_container\").append(sliderFlagHtml);\r\n        $(\".sm_sf_\"+thisSize).hover(function() {\r\n            $(this).toggleClass(\"activeFlag\");\r\n        }).click(function() {\r\n            $(thisId).prop(\"checked\", true);\r\n            moveSlider(fitValue, true);\r\n            return false;\r\n        });\r\n    }\r\n\r\n    function moveSlider(fitValue, shouldAnimate) {\r\n        var newWidth = sliderPos(fitValue, 0)+'%';\r\n        if (shouldAnimate) {\r\n            $('.slider_bar').stop().animate({width: newWidth});\r\n        } else {\r\n            $('.slider_bar').width(newWidth);\r\n        }\r\n    }\r\n\r\n    function moveAreaSlider(fitValue, matchMap, shouldAnimate) {\r\n        var smallestFit = 9999;\r\n        var biggestFit = 0;\r\n        var endX, startX, newWidth, newMarginLeft;\r\n        for(var measurement in matchMap) {\r\n            if (matchMap.hasOwnProperty(measurement)) {\r\n                if (isImportant(matchMap[measurement].importance, matchMap[measurement].componentFit)) {\r\n                    if (matchMap[measurement].componentFit > 0 && matchMap[measurement].componentFit < smallestFit) {\r\n                        smallestFit = matchMap[measurement].componentFit;\r\n                    }\r\n                    if (matchMap[measurement].componentFit > 0 && matchMap[measurement].componentFit > biggestFit) {\r\n                        biggestFit = matchMap[measurement].componentFit;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (fitValue > smallestFit) {\r\n            endX = sliderPos(fitValue, 0);\r\n            startX = sliderPos(smallestFit, 0);\r\n            newWidth = (endX - startX);\r\n            newMarginLeft = startX;\r\n        } else {\r\n            endX = sliderPos(biggestFit, 0);\r\n            startX = sliderPos(fitValue, 0);\r\n            newWidth = (endX - startX);\r\n            newMarginLeft = startX;\r\n        }\r\n\r\n        if (shouldAnimate) {\r\n            $('.slider_area').stop().animate({width: newWidth+'%', marginLeft: newMarginLeft+'%'});\r\n        } else {\r\n            $('.slider_area').width(newWidth+'%').css('marginLeft', newMarginLeft+'%');\r\n        }\r\n    }\r\n\r\n    function goWriteMessages(matchMap, missingMeasurements, accuracy) {\r\n        var $message = \"\";\r\n        var $message_type = \"\";\r\n        var $message_link = \"\";\r\n\r\n        $(\".sizeme_slider .slider_text_more_below\").empty();\r\n\r\n        if (!selectedProfile) {\r\n            $message_type = \"noMeasurements\";\r\n            $message_link = linkToSelectedProfile;\r\n            $message = i18n.MESSAGE.add_profiles;\r\n        } else {\r\n            if (missingMeasurements[0]) {\r\n                if (missingMeasurements[0].length > 0) {\r\n                    $message_type = \"missingMeasurements\";\r\n\t\t\t\t\t$message_link = linkToSelectedProfile;\r\n                    $message = i18n.MESSAGE.missing_measurements;\r\n                }\r\n            }\r\n\r\n            if (accuracy < accuracyThreshold) {\r\n                $message_type = \"noMeasurements\";\r\n\t\t\t\t$message_link = linkToSelectedProfile;\r\n                $message = i18n.MESSAGE.no_measurements;\r\n            }\r\n\t\t\t\r\n\t\t\tif ( (!$message_type) && (typeof matchMap.neck_opening_width !== \"undefined\") ) {\r\n\t\t\t\tif (matchMap.neck_opening_width.overlap < 0)\t{\r\n\t\t\t\t\t$message_type = \"info\";\r\n\t\t\t\t\t$message = i18n.MESSAGE.no_top_button;\r\n\t\t\t\t}\r\n\t\t\t}\r\n        }\r\n\r\n        if ($message_type) {\r\n\t\t\tif ($message_link) {\r\n\t\t\t\t$('<a></a>')\r\n\t\t\t\t\t.addClass(\"message_container \"+$message_type)\r\n\t\t\t\t\t.text($message)\r\n\t\t\t\t\t.attr(\"href\", linkToSelectedProfile)\r\n\t\t\t\t\t.attr(\"target\", \"_blank\")\r\n\t\t\t\t\t.appendTo(\".sizeme_slider .slider_text_more_below\");\r\n\t\t\t} else {\r\n\t\t\t\t$('<div></div>')\r\n\t\t\t\t\t.addClass(\"message_container \"+$message_type)\r\n\t\t\t\t\t.text($message)\r\n\t\t\t\t\t.appendTo(\".sizeme_slider .slider_text_more_below\");\r\n\t\t\t}\r\n        }\r\n    }\r\n\r\n    function selectToButtons(element) {\r\n        $(element+\" select\").hide();\r\n        var numClass = \"num_\"+$(element+\" option\").length;\r\n        var $content = $(document.createElement(\"div\")).addClass(\"sm-buttonset \"+numClass);\r\n        $(element+\" option\").each(function() {\r\n            var thisId = this.id;\r\n            var thisLabel = sizeText($(this).text());\r\n            var thisClass = $(this).attr(\"class\");\r\n            var thisVal = $(this).val();\r\n            var $div = $('<div>')\r\n                .addClass('sm-button '+thisClass)\r\n                .attr(\"id\", \"button_\"+thisId)\r\n                .text(thisLabel)\r\n                .on(\"click\", function() {\r\n                    $(\".sm-buttonset\").find(\".sm-selectable\").removeClass(\"sm-state-active\");\r\n                    $(\".element_for_\"+thisVal).addClass(\"sm-state-active\");\r\n                    $(sizeme_UI_options.sizeSelectionContainer).find(\"select\").val(thisVal);\r\n                    $(sizeme_UI_options.sizeSelectionContainer).find(\"select\").change();\t// yell change\r\n                    SizeMe.trackEvent(\"sizeChanged\", \"Store: Product size changed\");\r\n                });\r\n            $content.append($div);\r\n        });\r\n        $(element).append($content);\r\n    }\r\n\r\n    function getMaxY(data) {\r\n        var max = 0;\r\n        for (var i = 0; i < data.coords.length; i++) { max = Math.max(max, data.coords[i].Y); }\r\n        return max;\r\n    }\r\n\r\n    function getMaxX(data) {\r\n        var max = 0;\r\n        for(var i = 0; i < data.coords.length; i++) { max = Math.max(max, data.coords[i].X); }\r\n        return max;\r\n    }\r\n\r\n    function getMinX(data) {\r\n        var min = 99999;\r\n        for(var i = 0; i < data.coords.length; i++) { min = Math.min(min, data.coords[i].X); }\r\n        return min;\r\n    }\r\n\r\n    function getMinY(data) {\r\n        var min = 99999;\r\n        for(var i = 0; i < data.coords.length; i++) { min = Math.min(min, data.coords[i].Y); }\r\n        return min;\r\n    }\r\n\r\n    function getArced(p1, p2) {\r\n        var dX = p2.X - p1.X;\r\n        p2.cp1X = p1.X + Math.round(dX / arcRadius); p2.cp1Y = p1.Y + Math.round(dX / arcRadius);\r\n        p2.cp2X = p2.X - Math.round(dX / arcRadius); p2.cp2Y = p2.Y + Math.round(dX / arcRadius);\r\n        return true;\r\n    }\r\n\r\n    function liftCoords(data) {\r\n        data.nX = 0; data.nY = 0;\r\n        if (data.lift) {\r\n            for(var i = 1; i < data.coords.length; i++) {\r\n                var dX = data.coords[i].X - data.coords[i-1].X;\r\n                var dY = data.coords[i].Y - data.coords[i-1].Y;\r\n                var angleA = Math.atan2(dY, dX);\r\n                data.nX = Math.sin(angleA) * arrowLift;\r\n                data.nY = -Math.cos(angleA) * arrowLift;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    function getMidPoints(data) {\r\n        var dX = data.coords[1].X - data.coords[0].X;  var dY = data.coords[1].Y - data.coords[0].Y;\r\n        data.mid = {X: Math.round(dX / 2)+data.coords[0].X, Y: Math.round(dY / 2)+data.coords[0].Y };\r\n        if (data.style === \"arc\") { data.mid.Y += Math.round(dX / arcRadius * 0.7); }\r\n    }\r\n\r\n    function plotItem(c, data, isArrow, scale, offsetX, offsetY, highlighted) {\r\n        function pX(coord) {\r\n            return (coord*scale)+offsetX;\r\n        }\r\n        function pY(coord) {\r\n            return (coord*scale)+offsetY;\r\n        }\r\n\r\n        var i, j, lcp;\r\n\r\n        c.beginPath();\r\n\r\n        if (isArrow) {\t// ARROW\r\n            c.lineWidth = arrowLineWidth;\r\n            if (highlighted) {\r\n                c.lineWidth = arrowLineWidth + 2;\r\n            }\r\n            liftCoords(data);\r\n            c.moveTo(pX(data.coords[0].X+data.nX), pY(data.coords[0].Y+data.nY));\r\n            for(i = 1; i < data.coords.length; i++) {\r\n                switch (data.style) {\r\n                    case \"circle\":\r\n                        getArced(data.coords[i-1], data.coords[i]);\r\n                        c.bezierCurveTo(pX(data.coords[i].cp1X+data.nX), pY(data.coords[i].cp1Y+data.nY),\r\n                            pX(data.coords[i].cp2X+data.nX), pY(data.coords[i].cp2Y+data.nY),\r\n                            pX(data.coords[i].X+data.nX), pY(data.coords[i].Y+data.nY));\r\n                        c.bezierCurveTo(pX(-data.coords[i].cp1X+data.nX), pY(-data.coords[i].cp1Y+data.nY),\r\n                            pX(-data.coords[i].cp2X+data.nX), pY(-data.coords[i].cp2Y+data.nY),\r\n                            pX(data.coords[0].X+data.nX), pY(data.coords[0].Y+data.nY));\r\n                        break;\r\n                    case \"arc\":\r\n                        getArced(data.coords[i-1], data.coords[i]);\r\n                    /* falls through */\r\n                    case \"line\":\r\n                        if (typeof data.coords[i].cp1X !== 'undefined') {\r\n                            c.bezierCurveTo(pX(data.coords[i].cp1X+data.nX), pY(data.coords[i].cp1Y+data.nY), pX(data.coords[i].cp2X+data.nX), pY(data.coords[i].cp2Y+data.nY), pX(data.coords[i].X+data.nX), pY(data.coords[i].Y+data.nY));\r\n                        } else {\r\n                            c.lineTo(pX(data.coords[i].X+data.nX), pY(data.coords[i].Y+data.nY));\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n            c.stroke();\r\n\r\n            if (data.style === \"line\") {\r\n                // start and end circles\r\n                c.beginPath(); c.arc(pX(data.coords[0].X+data.nX), pY(data.coords[0].Y+data.nY), arrowEndRadius, 0, Math.PI*2, true); c.fill();\r\n                c.beginPath(); c.arc(pX(data.coords[data.coords.length-1].X+data.nX), pY(data.coords[data.coords.length-1].Y+data.nY), arrowEndRadius, 0, Math.PI*2, true);\tc.fill();\r\n            }\r\n\r\n            // mid circle\r\n            getMidPoints(data);\r\n            if (typeof data.midCircle !== 'undefined') { data.mid.X = data.midCircle.X; data.mid.Y = data.midCircle.Y; }\r\n            var rad = arrowNumberRadius;\r\n            if (highlighted) {\r\n                rad += 5;\r\n            }\r\n            c.beginPath(); c.arc(pX(data.mid.X+data.nX), pY(data.mid.Y+data.nY), rad, 0, Math.PI*2, true); c.fill();\r\n            c.beginPath(); c.fillStyle = \"#FFFFFF\"; c.font = arrowNumberFont; c.textAlign = \"center\"; c.textBaseline = \"middle\";\r\n            if (highlighted) {\r\n                c.font = arrowNumberHighlightFont;\r\n            }\r\n            c.fillText(data.num, pX(data.mid.X+data.nX), pY(data.mid.Y+data.nY));\r\n\r\n        } else {\t// ITEM\r\n            c.fillStyle = fillColor; c.strokeStyle = fillColor; c.lineWidth = 0.1;\r\n\r\n            c.moveTo(pX(data.coords[0].X), pY(data.coords[0].Y));\r\n\r\n            for(i = 1; i < data.coords.length; i++) {\r\n                if (typeof data.coords[i].cp1X !== 'undefined') {\r\n                    c.bezierCurveTo(pX(data.coords[i].cp1X), pY(data.coords[i].cp1Y), pX(data.coords[i].cp2X), pY(data.coords[i].cp2Y), pX(data.coords[i].X), pY(data.coords[i].Y));\r\n                } else {\r\n                    c.lineTo(pX(data.coords[i].X), pY(data.coords[i].Y));\r\n                }\r\n            }\r\n\r\n            if (data.mirror) {\r\n                lcp = [{X: null, Y: null}, {X: null, Y: null}];\r\n\r\n                for(i = data.coords.length-1; i >= 0; i--) {\r\n                    if (lcp[0].X) {\r\n                        c.bezierCurveTo(pX(lcp[0].X), pY(lcp[0].Y), pX(lcp[1].X), pY(lcp[1].Y), pX(-data.coords[i].X), pY(data.coords[i].Y));\r\n                    } else {\r\n                        c.lineTo(pX(-data.coords[i].X), pY(data.coords[i].Y));\r\n                    }\r\n\r\n                    if (typeof data.coords[i].cp1X !== 'undefined') {\r\n                        lcp[0].X = -data.coords[i].cp2X; lcp[0].Y = data.coords[i].cp2Y;\r\n                        lcp[1].X = -data.coords[i].cp1X; lcp[1].Y = data.coords[i].cp1Y;\r\n                    } else {\r\n                        lcp = [{X: null, Y: null}, {X: null, Y: null}];\r\n                    }\r\n                }\r\n            }\r\n\r\n            c.fill();\r\n            c.stroke();\r\n\r\n            // accents\r\n            c.fillStyle = drawColor; c.strokeStyle = drawColor; c.lineWidth = itemLineWidth;\r\n            c.lineCap = \"butt\"; c.lineJoin = \"miter\"; c.miterLimit = 1;\r\n\r\n            for(i = 0; i < data.accents.length; i++) {\r\n                c.beginPath();\r\n                if (data.accents[i].type === \"circle\") {\r\n                    c.arc(pX(data.accents[i].coords[0].X), pY(data.accents[i].coords[0].Y), data.accents[i].coords[0].R*realCanvasWidth/1000, 0, Math.PI*2, true);\r\n                } else {\r\n                    c.moveTo(pX(data.accents[i].coords[0].X), pY(data.accents[i].coords[0].Y));\r\n                    for(j = 1; j < data.accents[i].coords.length; j++) {\r\n                        if (typeof data.accents[i].coords[j].cp1X !== 'undefined') {\r\n                            c.bezierCurveTo(pX(data.accents[i].coords[j].cp1X), pY(data.accents[i].coords[j].cp1Y), pX(data.accents[i].coords[j].cp2X), pY(data.accents[i].coords[j].cp2Y), pX(data.accents[i].coords[j].X), pY(data.accents[i].coords[j].Y));\r\n                        } else {\r\n                            c.lineTo(pX(data.accents[i].coords[j].X), pY(data.accents[i].coords[j].Y));\r\n                        }\r\n                    }\r\n                }\r\n                if (data.accents[i].type === \"area\") {\r\n                    c.fill();\r\n                }\r\n                c.stroke();\r\n\r\n                if (data.mirror) {\r\n                    if (typeof data.accents[i].noMirror === 'undefined') {\r\n                        lcp = [{X: null, Y: null}, {X: null, Y: null}];\r\n                        c.beginPath();\r\n                        c.moveTo(pX(-data.accents[i].coords[data.accents[i].coords.length-1].X), pY(data.accents[i].coords[data.accents[i].coords.length-1].Y));\r\n                        for(j = data.accents[i].coords.length-1; j >= 0; j--) {\r\n                            if (lcp[0].X) {\r\n                                c.bezierCurveTo(pX(lcp[0].X), pY(lcp[0].Y), pX(lcp[1].X), pY(lcp[1].Y), pX(-data.accents[i].coords[j].X), pY(data.accents[i].coords[j].Y));\r\n                            } else {\r\n                                c.lineTo(pX(-data.accents[i].coords[j].X), pY(data.accents[i].coords[j].Y));\r\n                            }\r\n\r\n                            if (typeof data.accents[i].coords[j].cp1X !== 'undefined') {\r\n                                lcp[0].X = -data.accents[i].coords[j].cp2X; lcp[0].Y = data.accents[i].coords[j].cp2Y;\r\n                                lcp[1].X = -data.accents[i].coords[j].cp1X; lcp[1].Y = data.accents[i].coords[j].cp1Y;\r\n                            } else {\r\n                                lcp = [{X: null, Y: null}, {X: null, Y: null}];\r\n                            }\r\n                        }\r\n                        if (data.accents[i].type === \"area\") {\r\n                            c.fill();\r\n                        }\r\n                        c.stroke();\r\n                    }\r\n                }\r\n            } // end for accents\r\n        }\r\n    }\r\n\r\n    function writeItemCanvas(canvas_id, matchMap, highlight) {\r\n\r\n        if (document.getElementById(canvas_id).getContext) {\r\n            var c = document.getElementById(canvas_id).getContext('2d');\r\n            $(\"#\"+canvas_id).attr(\"width\", realCanvasWidth).attr(\"height\", realCanvasHeight);\r\n\r\n            // get scale and offsets\r\n            var canvasWidth = realCanvasWidth * (1-(2*padding));\r\n            var canvasHeight = realCanvasHeight * (1-(2*padding));\r\n\r\n            var maxX = getMaxX(item_drawing) - getMinX(item_drawing);\r\n            if (item_drawing.mirror) {\r\n                maxX = getMaxX(item_drawing) * 2;\r\n            }\r\n            var maxY = getMaxY(item_drawing) - getMinY(item_drawing);\r\n            var scale = 1;\r\n            if (maxX !== 0) {\r\n                scale = canvasWidth / maxX;\r\n            }\r\n            if (maxY !== 0 && (canvasWidth/canvasHeight) > (maxX/maxY)) {\r\n                scale = canvasHeight / maxY;\r\n            }\r\n\r\n            var offsetX = (realCanvasWidth - ((getMaxX(item_drawing) + getMinX(item_drawing)) * scale)) / 2;\r\n            if (item_drawing.mirror) {\r\n                offsetX = realCanvasWidth / 2;\r\n            }\r\n            var offsetY = (realCanvasHeight - ((getMaxY(item_drawing) + getMinY(item_drawing))*scale)) / 2;\r\n\r\n            // item\r\n            plotItem(c, item_drawing, false, scale, offsetX, offsetY, false);\r\n            var inputKey = $(sizeme_UI_options.sizeSelectionContainer).find(\"select\").val();\r\n\r\n            // arrows\r\n            if (matchMap) {\r\n                // Detailed\r\n                sizeme_product.item.measurements[inputKey].each(function(measurement) {\r\n                    if (sizeme_product.item.measurements[inputKey][measurement] > 0 && measurement_arrows[measurement]) {\r\n                        // var draw = (matchMap[measurement].componentFit > 0);\r\n                        var draw = true;\r\n                        if (draw) {\r\n                            c.strokeStyle = measurement_arrows[measurement].color;\r\n                            c.fillStyle = measurement_arrows[measurement].color;\r\n                            plotItem(c, measurement_arrows[measurement], true, scale, offsetX, offsetY, (measurement === highlight && highlight !== null));\r\n                        }\r\n                    }\r\n                });\r\n            } else {\r\n                // Size Guider\r\n                if (!inputKey) {\r\n                    inputKey = Object.keys(sizeme_product.item.measurements)[0];\r\n                }\r\n                if (inputKey) {\r\n                    sizeme_product.item.measurements[inputKey].each(function(measurement) {\r\n                        if (sizeme_product.item.measurements[inputKey][measurement] > 0 && measurement_arrows[measurement]) {\r\n                            c.strokeStyle = measurement_arrows[measurement].color;\r\n                            c.fillStyle = measurement_arrows[measurement].color;\r\n                            plotItem(c, measurement_arrows[measurement], true, scale, offsetX, offsetY, (measurement === highlight && highlight !== null));\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function initOpentip() {\r\n        Opentip.lastZIndex = 10000;\r\n        Opentip.styles.myDefaultStyle = {\r\n            //target: true,\r\n            //tipJoint: \"center top\",\r\n            group: \"myTips\"\r\n        };\r\n        Opentip.defaultStyle = \"myDefaultStyle\";\r\n    }\r\n\r\n    function hasNeckOpening() {\r\n        var inputKey = $(sizeme_UI_options.sizeSelectionContainer).find(\"select\").val();\r\n        if (!inputKey) {\r\n            inputKey = Object.keys(sizeme_product.item.measurements)[0];\r\n        }\r\n\t\tvar retval = false;\r\n\t\tif (typeof sizeme_product.item.measurements[inputKey] !== undefined) {\r\n\t\t\tif (typeof sizeme_product.item.measurements[inputKey].neck_opening_width !== undefined) {\r\n\t\t\t\tretval = (sizeme_product.item.measurements[inputKey].neck_opening_width > 0);\r\n\t\t\t}\r\n\t\t}\r\n        return retval;\r\n    }\r\n\r\n    function noThanks() {\r\n        return readCookie(\"sizeme_no_thanks\") === \"true\";\r\n    }\r\n\r\n    function noProductSplash() {\r\n        return readCookie(\"sizeme_no_product_splash\") === \"true\";\r\n    }\r\n\r\n    function writeDetailedWindow(isSizeGuide) {\r\n        // create detailed dialog window\r\n        itemName = sizeme_product.name;\r\n        var txts = i18n.DETAILED;\r\n        var linkTarget = \".sizeme_slider .slider_text_below\";\r\n\r\n        initOpentip();\r\n\r\n        if (isSizeGuide) {\r\n\t\t\ttxts = i18n.SIZE_GUIDE;\r\n            linkTarget = sizeme_UI_options.appendContentTo;\r\n        }\r\n\r\n        var $dialog = $('<div id=\"sizeme_detailed_view_content\"></div>')\r\n            .dialog({\r\n                position: { my: \"center\", at: \"center\", of: window },\r\n                autoOpen: false,\r\n                dialogClass: \"sizeme_detailed_view_window\",\r\n                minHeight: 620,\r\n                minWidth: 940,\r\n\t\t\t\tscaleH: 1,\r\n\t\t\t\tscaleW: 1,\r\n\t\t\t\tcloseText: i18n.COMMON.close_text,\r\n                title: txts.window_title+' <span class=\"name\">'+itemName+'</span>'\r\n            });\r\n\r\n        // add toggle link to main page\r\n        $(\"<a class='a_button sm_detailed_view\"+(isSizeGuide ? \" size_guide\" : \"\")+\"' id='popup_opener' href='#'>\"+txts.button_text+\"</a>\")\r\n            .click(function() {\r\n                if (isSizeGuide) {\r\n                    SizeMe.trackEvent(\"sizeGuideOpened\", \"Store: Size guide opened\");\r\n                } else {\r\n                    SizeMe.trackEvent(\"detailedViewOpened\", \"Store: Detailed view opened\");\r\n                }\r\n                $dialog.dialog('open');\r\n                return false;\r\n            })\r\n            .appendTo(linkTarget);\r\n\r\n        // write two columns\r\n        $(\"<div class='dialog_col' id='col1'></div><div class='dialog_col' id='col2'></div>\").appendTo(\"#sizeme_detailed_view_content\");\r\n\r\n        // add bottom title bar\r\n        $(\"<div class='sm-bottombar ui-dialog-bottombar'></div>\").appendTo(\"#sizeme_detailed_view_content\");\r\n\r\n        // write item image canvas to first column\r\n        $(\"<div class='sizeme_detailed_section'></div>\")\r\n            .append(\"<canvas id='sizeme_item_view'></canvas>\")\r\n            .appendTo(\"#col1\");\r\n\r\n        // add shopping for selection to second (no cloning)\r\n        if (!isSizeGuide) {\r\n            $(\"<div class='sizeme_detailed_section'></div>\")\r\n                .append(\"<h2>\"+i18n.COMMON.shopping_for+\"</h2>\")\r\n                .append(\"<div class='shopping_for'></div>\")\r\n                .appendTo(\"#col2\");\r\n\r\n            // clone buttons to second\r\n            var $clone = $(sizeme_UI_options.sizeSelectionContainer).clone(true, true);\r\n            $clone.find(\"[id]\").each(function() {\r\n                this.id = \"clone_\"+this.id;\r\n                $(this).addClass(\"cloned\");\r\n                if (this.name) {\r\n                    this.name = \"clone_\"+this.name;\r\n                }\r\n            });\r\n            $(\"<div class='sizeme_detailed_section'></div>\")\r\n                .append(\"<h2>\"+i18n.COMMON.selected_size+\"</h2>\")\r\n                .append($clone)\r\n                .appendTo(\"#col2\");\r\n\r\n            // clone slider (without detailed view toggler and in content stuff)\r\n            var $slider_clone = $(\".sizeme_slider\")\r\n                .clone(true, true)\r\n                .find(\".slider_text_below\").remove()\r\n                .end();\r\n\r\n            $(\"<div class='sizeme_detailed_section'></div>\")\r\n                .append(\"<h2>\"+i18n.FIT_INFO.overall_fit+\"</h2>\")\r\n                .append($slider_clone)\r\n                .appendTo(\"#col2\");\r\n        }\r\n\r\n        // write detailed table to col 2\r\n        $(\"<div class='sizeme_detailed_section'></div>\")\r\n            .append(\"<h2>\"+txts.table_title+\"</h2>\")\r\n            .append(\"<table id='detailed_table'><tbody></tbody></table>\")\r\n            .appendTo(\"#col2\");\r\n\r\n        // bind hover event to run_highlights\r\n        $(\"#detailed_table\").on(\"mouseenter\", \".run_highlight\", function () {\r\n            var highlight = $(this).data(\"measurement\");\r\n            $(this).find(\"td.cell_\"+highlight).addClass(\"highlighted\");\r\n            var $matchMap = $(\"#detailed_table\").find(\"tbody\").data(\"matchMap\");\r\n            writeItemCanvas('sizeme_item_view', $matchMap, highlight);\r\n            if (sizeme_local_options.fitAreaSlider && $matchMap) {\r\n                if ($matchMap[highlight]) {\r\n                    if (($matchMap[highlight].componentFit > 0) && (isImportant($matchMap[highlight].importance, $matchMap[highlight].componentFit))) {\r\n                        drawExtraSlider($matchMap[highlight].componentFit);\r\n                    }\r\n                }\r\n            }\r\n        }).on(\"mouseleave\", \".run_highlight\", function () {\r\n            var highlight = $(this).data(\"measurement\");\r\n            $(this).find(\"td.cell_\"+highlight).removeClass(\"highlighted\");\r\n            writeItemCanvas('sizeme_item_view', $(\"#detailed_table\").find(\"tbody\").data(\"matchMap\"), \"\");\r\n            if (sizeme_local_options.fitAreaSlider) {\r\n                killExtraSlider();\r\n            }\r\n        });\r\n\r\n        // disclaimers\r\n        if (isSizeGuide) {\r\n            var $txt = i18n.SIZE_GUIDE.measurement_disclaimer;\r\n            if (hasNeckOpening()) {\r\n                $txt += \"<br />\"+i18n.SIZE_GUIDE.measurement_disclaimer_collar;\r\n            }\r\n            if (isInside()) {\r\n                $txt = i18n.SIZE_GUIDE.measurement_disclaimer_inside;\r\n            }\r\n            $(\"<div class='sizeme_explanation'></div>\")\r\n                .append(\"<p>\"+$txt+\"</p>\")\r\n                .appendTo(\"#col2\");\r\n\r\n            if (sizeme_options.service_status === \"on\") {\r\n                $(\"<div class='sizeme_advertisement'></div>\")\r\n                    .append(\"<p>\"+i18n.SIZE_GUIDE.advertisement+\" \" +\r\n                        \"<a id='sizeme_ad_link' href='\" + SizeMe.contextAddress + \"' class='logo' target='_blank'></a></p>\")\r\n                    .appendTo(\"#sizeme_detailed_view_content\");\r\n                $(\"#sizeme_ad_link\").on(\"click\", function() {\r\n                    clearAuthToken();\r\n                    if (noThanks()) {\r\n                        eraseCookie(\"sizeme_no_thanks\");\r\n                        $(\".splash\").fadeIn();\r\n                        return false;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    function isImportant(importance, componentFit) {\r\n        return (importance === 1 || ((importance === -1) && (componentFit < 1000)));\r\n    }\r\n\r\n    function colorCell($cell, value, arrow) {\r\n        if (arrow) {\r\n            arrow.color = arrowColorInfo;\r\n        }\r\n        if (value) {\r\n            var selectedFit = getFit(value.componentFit, value.importance);\r\n\t\t\t$cell.addClass(selectedFit.label);\r\n\t\t\tif (arrow) {\r\n\t\t\t\tarrow.color = selectedFit.arrowColor;\r\n\t\t\t}\r\n        }\r\n        return $cell;\r\n    }\r\n\r\n    function getMissingMeasurement(missingMeasurements, measurement) {\r\n        for(var $i = 0; $i < missingMeasurements.length; $i++) {\r\n            if (missingMeasurements[$i][0] === measurement) {\r\n                return missingMeasurements[$i][1];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    function isPinched(measurement) { return (PINCHED_FITS.indexOf(measurement) >= 0); }\r\n    function isLongFit(measurement) { return (LONG_FITS.indexOf(measurement) >= 0); }\r\n\r\n    function isPinchedTxt(measurement) {\r\n        if (isPinched(measurement)) {\r\n            return \" \"+i18n.FIT_INFO.when_pinched;\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n    function getStretchedTxt(stretch_value) {\r\n        if (stretch_value > 0) {\r\n            if (stretch_value < 25) {\r\n                return i18n.FIT_INFO.stretched_little+\"  \";\r\n            } else if (stretch_value < 75) {\r\n                return i18n.FIT_INFO.stretched_somewhat+\"  \";\r\n            } else if (stretch_value < 95) {\r\n                return i18n.FIT_INFO.stretched_much+\"  \";\r\n            } else {\r\n                return i18n.FIT_INFO.stretched_max+\"  \";\r\n            }\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n\r\n    function updateDetailedTable(matchMap, inputKey, missingMeasurements) {\r\n        var $table = $(\"#detailed_table\").find(\"tbody\"),\r\n            $row, $i, $tip, $txt;\r\n        $table.empty();\r\n        if (matchMap) {\r\n            // *** Detailed View ***\r\n            $table.data(\"matchMap\", matchMap);\r\n\r\n            $row = $(document.createElement(\"tr\")).addClass(\"header_row\");\r\n            $i = 0;\r\n            sizeme_product.item.measurements[inputKey].each(function(measurement) {\r\n                if (sizeme_product.item.measurements[inputKey][measurement] > 0) {\r\n                    var $txt = '<span class=\"num\">'+(++$i)+'</span>'+i18n.MEASUREMENT[measurement];\r\n                    if (measurement_arrows[measurement]) {\r\n                        measurement_arrows[measurement].num = $i;\r\n                    }\r\n                    $row.append($(document.createElement(\"td\")).html($txt).addClass(\"run_highlight cell_\"+measurement).data(\"measurement\", measurement));\r\n                }\r\n            });\r\n            $table.append($row);\r\n\r\n            var $tip_txts = [];\r\n            var $tip_classes = [];\r\n\r\n            if (sizeme_local_options.writeOverlaps) {\r\n                $row = $(document.createElement(\"tr\")).addClass(\"data_row\");\r\n                sizeme_product.item.measurements[inputKey].each(function(measurement) {\r\n                    var drawReason = 0;\r\n                    if (matchMap[measurement] && matchMap[measurement].componentFit > 0) {\r\n                        drawReason = 1;\r\n                    }\r\n                    if (sizeme_product.item.measurements[inputKey][measurement] > 0) {\r\n                        drawReason = 2;\r\n                    }\r\n                    if (drawReason > 0) {\r\n                        var $txt = \"\";\r\n\t\t\t\t\t\tvar $meas_top = 0;\r\n                        $tip_txts[measurement] = i18n.FIT_INFO.the_item+\" \"+i18n.MEASUREMENT[measurement].toLowerCase()+\" \"+i18n.FIT_INFO.the_measurement+\" \";\r\n\r\n                        if (matchMap[measurement]) {\r\n                            $txt = (matchMap[measurement].overlap/10).toFixed(1)+\" cm\";\r\n                            if (isPinched(measurement)) {\r\n                                $txt = (matchMap[measurement].overlap/20).toFixed(1)+\" cm\";\r\n                            }\r\n                            if ((matchMap[measurement].overlap <= 0) && (matchMap[measurement].componentFit >= 1000)) {\r\n                                $txt = \"0.0 cm\";\r\n                            }\r\n\r\n\t\t\t\t\t\t\tswitch(measurement) {\r\n\t\t\t\t\t\t\t\tcase \"sleeve\":\r\n\t\t\t\t\t\t\t\t\tvar $sleeve_txt = \"<div class='sleeve\" + (matchMap[measurement].overlap < 0 ? \" negative_overlap\" : \"\") + \"'>\";\r\n\t\t\t\t\t\t\t\t\tvar $sleeve_height = Math.round(29 + (75*(matchMap[measurement].percentage / 0.3)));\t// zero-point + (wrist_to_finger * (overlap_percentage / normal_finger_ratio))\r\n\t\t\t\t\t\t\t\t\t$sleeve_height = Math.max(11, $sleeve_height);\t// never under 11 (34 px)\r\n\t\t\t\t\t\t\t\t\t$sleeve_height = Math.min(105, $sleeve_height);\t// never over overlap image height\r\n\r\n\t\t\t\t\t\t\t\t\t$meas_top = Math.round((($sleeve_height - 29) / 2)+29-9);\r\n\t\t\t\t\t\t\t\t\tif (($sleeve_height - 29) < 14) { // no fit in middle if no room\r\n\t\t\t\t\t\t\t\t\t\t$meas_top = $sleeve_height+23;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (matchMap[measurement].overlap < 0) {\r\n\t\t\t\t\t\t\t\t\t\t$sleeve_txt += \"<div class='meas' style='top:14px;left:-7px;'>\"+$txt+\"</div>\";\t// negative overlap in different place\r\n\t\t\t\t\t\t\t\t\t\tif (matchMap[measurement].componentFit >= 1000) {\r\n\t\t\t\t\t\t\t\t\t\t\t$sleeve_height = 29;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t$sleeve_txt += \"<div class='meas' style='top:\"+$meas_top+\"px;\";\r\n\t\t\t\t\t\t\t\t\t\tif (matchMap[measurement].overlap >= 100) {\r\n\t\t\t\t\t\t\t\t\t\t\t$sleeve_txt += \"left:-7px;\";\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t$sleeve_txt += \"'>\"+$txt+\"</div>\";\t// mid point?\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t$sleeve_txt += \"<div class='sleeve_overlap' style='height:\"+($sleeve_height+23)+\"px;'></div>\";\t// sleeve + image bottom clearance\r\n\t\t\t\t\t\t\t\t\t$sleeve_txt += \"</div>\";\r\n\t\t\t\t\t\t\t\t\t$tip_txts[measurement] = $sleeve_txt + $tip_txts[measurement];\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase \"front_height\":\r\n\t\t\t\t\t\t\t\t\tvar $front_height_txt = \"<div class='front_height\" + (matchMap[measurement].overlap < 0 ? \" negative_overlap\" : \"\") + \"'>\";\r\n\t\t\t\t\t\t\t\t\tvar $front_height_height = Math.round(25 + (matchMap[measurement].percentage*(9 / 0.05)));\t// zero-point + (overlap_percentage * (pant waistband height in px / pant waistband in %))\r\n\t\t\t\t\t\t\t\t\t$front_height_height = Math.max(0, $front_height_height);\t// never under 0 (+23 = 34 px)\r\n\t\t\t\t\t\t\t\t\t$front_height_height = Math.min(105, $front_height_height);\t// never over overlap image height (+23 px)\r\n\r\n\t\t\t\t\t\t\t\t\t$meas_top = Math.round((($front_height_height - 25) / 2)+25-9);\r\n\t\t\t\t\t\t\t\t\tif (($front_height_height - 25) < 12) { // no fit in middle if no room\r\n\t\t\t\t\t\t\t\t\t\t$meas_top = $front_height_height+23;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (matchMap[measurement].overlap < 0) {\r\n\t\t\t\t\t\t\t\t\t\t$front_height_txt += \"<div class='meas' style='top:14px;left:-7px;'>\"+$txt+\"</div>\";\t// negative overlap in different place\r\n\t\t\t\t\t\t\t\t\t\tif (matchMap[measurement].componentFit >= 1000) {\r\n\t\t\t\t\t\t\t\t\t\t\t$front_height_height = 28;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t$front_height_txt += \"<div class='meas' style='top:\"+$meas_top+\"px;\";\r\n\t\t\t\t\t\t\t\t\t\tif (matchMap[measurement].overlap >= 100) {\r\n\t\t\t\t\t\t\t\t\t\t\t$front_height_txt += \"left:-12px;\";\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t$front_height_txt += \"'>\"+$txt+\"</div>\";\t// mid point?\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t$front_height_txt += \"<div class='front_height_overlap' style='height:\"+($front_height_height+23)+\"px;'></div>\";\t// front_height + image (arrow) bottom clearance\r\n\t\t\t\t\t\t\t\t\t$front_height_txt += \"</div>\";\r\n\t\t\t\t\t\t\t\t\t$tip_txts[measurement] = $front_height_txt + $tip_txts[measurement];\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n                            }\t// end switch measurement\t\t\t\t\t\r\n\r\n                            if (matchMap[measurement].overlap <= 0) {\r\n                                if (matchMap[measurement].componentFit >= 1000) {\r\n                                    $txt = \"0.0 cm\";\r\n                                    $tip_txts[measurement] += i18n.FIT_INFO.no_overlap+\"  \";\r\n                                    $tip_txts[measurement] += getStretchedTxt(matchMap[measurement].componentStretch);\r\n                                } else {\r\n                                    $tip_txts[measurement] += i18n.FIT_INFO.is_smaller+\" \";\r\n                                    $tip_txts[measurement] += $txt.replace(\"-\",\"\");\r\n                                    $tip_txts[measurement] += isPinchedTxt(measurement)+\".  \";\r\n                                }\r\n                            } else {\r\n                                if (isPinched(measurement)) {\r\n                                    $tip_txts[measurement] = \"<div class='pinched'><div class='meas'>\"+$txt+\"</div></div>\" + $tip_txts[measurement];\r\n                                }\r\n\r\n                                $txt = \"+\"+$txt;\r\n                                $tip_txts[measurement] += i18n.FIT_INFO.overlaps_you+\" <b>\"+$txt+\"</b>\"+isPinchedTxt(measurement);\r\n                                if (measurement === \"sleeve\") {\r\n                                    $tip_txts[measurement] += \" \"+i18n.FIT_INFO.arm_sleeve_straight;\r\n                                }\r\n                                $tip_txts[measurement] += \".  \";\r\n                            }\r\n\r\n                            if (matchMap[measurement].componentFit > 0) {\r\n                                var $fitVerdict = i18n.FIT_VERDICT[getFit(matchMap[measurement].componentFit, matchMap[measurement].importance).label];\r\n                                if (isLongFit(measurement)) {\r\n                                    $fitVerdict = i18n.FIT_VERDICT_LONG[getFit(matchMap[measurement].componentFit, matchMap[measurement].importance).label];\r\n                                }\r\n                                $tip_txts[measurement] += i18n.FIT_INFO.sm_considers_fit+\" <b>\"+$fitVerdict.toLowerCase()+\"</b>.\";\r\n                            }\r\n\r\n                        } else if (sizeme_product.item.measurements[inputKey][measurement] > 0) {\r\n                            $txt = (sizeme_product.item.measurements[inputKey][measurement]/10).toFixed(1)+\" cm\";\r\n                            $tip_txts[measurement] += i18n.COMMON.is+\" \"+$txt+\".  \";\r\n                            if (missingMeasurements) {\r\n                                if (getMissingMeasurement(missingMeasurements, measurement) !== null) {\r\n                                    $tip_txts[measurement] += i18n.MESSAGE.add_this_measurement;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        var $cell = $(document.createElement(\"td\"))\r\n                            .text($txt)\r\n                            .attr(\"id\",\"overlap_\"+measurement)\r\n                            .addClass(\"run_highlight cell_\"+measurement)\r\n                            .data(\"measurement\", measurement);\r\n                        $row.append(colorCell($cell, matchMap[measurement], measurement_arrows[measurement]));\r\n                        $tip_classes[measurement] = \"\";\r\n                        if (isPinched(measurement)) {\r\n                            $tip_classes[measurement] = \"isPinched\";\r\n                        }\r\n                        if (measurement === \"sleeve\") {\r\n                            $tip_classes[measurement] = \"sleeve\";\r\n                        }\r\n                        $tip = new Opentip($cell, $tip_txts[measurement], { className: $tip_classes[measurement] } );\r\n                    }\r\n                });\r\n                $table.append($row);\r\n            }\r\n\r\n            $row = $(document.createElement(\"tr\")).addClass(\"data_row fit_label_row\");\r\n            sizeme_product.item.measurements[inputKey].each(function(measurement, value) {\r\n                var $cell;\r\n                if (matchMap[measurement]) {\r\n                    if (matchMap[measurement].componentFit > 0) {\r\n                        $txt = i18n.FIT_VERDICT[getFit(matchMap[measurement].componentFit, matchMap[measurement].importance).label];\r\n\t\t\t\t\t\t\r\n                        if (isLongFit(measurement)) {\r\n                            $txt = i18n.FIT_VERDICT_LONG[getFit(matchMap[measurement].componentFit, matchMap[measurement].importance).label];\r\n                        }\r\n\t\t\t\t\t\t\r\n                        $cell = $(document.createElement(\"td\"))\r\n                            .html('<div>'+$txt+'</div>')\r\n                            .addClass(\"run_highlight\")\r\n                            .data(\"measurement\", measurement);\r\n\t\t\t\t\t\t\r\n                        $row.append(colorCell($cell, matchMap[measurement], measurement_arrows[measurement]));\r\n                    } else if (sizeme_product.item.measurements[inputKey][measurement] > 0) {\r\n                        $txt = \"\";\r\n                        $cell = $(document.createElement(\"td\"))\r\n                            .html($txt)\r\n                            .addClass(\"info run_highlight cell_\"+measurement)\r\n                            .data(\"measurement\", measurement);\r\n                        $row.append($cell);\r\n                    }\r\n                } else if (sizeme_product.item.measurements[inputKey][measurement] > 0) {\r\n                    $txt = \"\";\r\n                    var $class = \"\",\r\n                        missing;\r\n                    if (missingMeasurements) {\r\n                        if ((missing = getMissingMeasurement(missingMeasurements, measurement)) !== null) {\r\n                            $txt = \"<a target='_blank' href='\"+linkToSelectedProfile+\"#\"+missing+\"'>\"+i18n.COMMON.add_to_profile+\"</a>\";\r\n                            $class = \" add\";\r\n                        }\r\n                    }\r\n                    $cell = $(document.createElement(\"td\"))\r\n                        .html($txt)\r\n                        .addClass(\"info run_highlight cell_\"+measurement+$class)\r\n                        .data(\"measurement\", measurement);\r\n                    $row.append($cell);\r\n                }\r\n                if ($cell) {\r\n                    $tip = new Opentip($cell, $tip_txts[measurement], { className: $tip_classes[measurement] } );\r\n                }\r\n            });\r\n            $table.append($row);\r\n\r\n        } else {\r\n            // *** Size Guide ***\r\n            $row = $(document.createElement(\"tr\")).addClass(\"header_row\");\r\n            $i = 0;\r\n            var $first = Object.keys(sizeme_product.item.measurements)[0],\r\n                $j, measurement;\r\n            $row.append($(document.createElement(\"td\")).html(i18n.COMMON.size).addClass(\"size_column\"));\r\n            for ($j = 0; $j < FIT_ORDER.length; $j++) {\r\n                measurement = FIT_ORDER[$j];\r\n                if (sizeme_product.item.measurements[$first][measurement] > 0) {\r\n                    $txt = '<span class=\"num\">'+(++$i)+'</span>'+i18n.MEASUREMENT[measurement];\r\n                    if (measurement_arrows[measurement]) {\r\n                        measurement_arrows[measurement].num = $i;\r\n                    }\r\n                    $row.append($(document.createElement(\"td\")).html($txt).addClass(\"run_highlight cell_\"+measurement).data(\"measurement\", measurement));\r\n                }\r\n            }\r\n            $table.append($row);\r\n\r\n            for ($i=0;$i<sizeKeys.length;$i++) {\r\n                var key = sizeKeys[$i].key, $cell;\r\n\r\n                var $class = \"data_row\";\r\n                if (key === inputKey) {\r\n                    $class += \" active\";\r\n                }\r\n\r\n                $row = $(document.createElement(\"tr\")).addClass($class);\r\n\r\n                $row.append($(document.createElement(\"td\")).html(sizeText(sizeKeys[$i].sizeLabel)).addClass(\"size_column\"));\r\n                for ($j = 0; $j < FIT_ORDER.length; $j++) {\r\n                    measurement = FIT_ORDER[$j];\r\n                    if (sizeme_product.item.measurements[key][measurement] > 0) {\r\n                        $txt = (sizeme_product.item.measurements[key][measurement]/10).toFixed(1);\r\n                        $cell = $(document.createElement(\"td\")).text($txt+\" cm\").addClass(\"run_highlight cell_\"+measurement).data(\"measurement\", measurement);\r\n                        $row.append(colorCell($cell, \"\", measurement_arrows[measurement]));\r\n                    }\r\n                }\r\n                $table.append($row);\r\n            }\r\n        }\r\n\r\n        writeItemCanvas('sizeme_item_view', matchMap, \"\");\r\n\r\n    }\r\n\r\n    function updateDetailedSliderTip(thisSize, thisFit) {\r\n        // tip for overall slider in detailed\r\n        var $trigger = $(\"#sizeme_detailed_view_content\").find(\".slider_container\");\r\n        var $tip_txt = i18n.FIT_INFO.overall_fit_for_size+\" \"+sizeText(thisSize)+\"</b>\";\r\n        $tip_txt += \" \"+i18n.COMMON.is+\" <b>\"+i18n.FIT_VERDICT[getFit(thisFit, 1).label].toLowerCase()+\"</b>\";\r\n        var $tip = new Opentip($trigger, $tip_txt);\r\n    }\r\n\r\n    function updateSlider(thisSize, thisData, isRecommended, detailedContainer, animateSlider) {\r\n        var thisFit = thisData.totalFit;\r\n        var thisLabel = thisData.fitRangeLabel;\r\n        var matchMap = thisData.matchMap;\r\n        moveSlider(thisFit, animateSlider);\r\n        if (sizeme_local_options.fitAreaSlider) {\r\n            moveAreaSlider(thisFit, matchMap, animateSlider);\r\n        }\r\n        if (sizeme_local_options.writeMessages) {\r\n            goWriteMessages(matchMap, thisData.missingMeasurements, thisData.accuracy);\r\n        }\r\n        updateDetailedSliderTip(thisSize, thisFit);\r\n        updateDetailedTable(matchMap, thisData.inputKey, thisData.missingMeasurements);\r\n    }\r\n\r\n    function getStandardHeader() {\r\n        // *** SizeMe Header injection\r\n        var headerHtml = \"<div id='sizeme_header' class='in_content'>\";\r\n        headerHtml += \"<div id='logo'></div>\";\r\n        headerHtml += \"<div class='sizeme_header_content'>\";\r\n        headerHtml += \"<div class='shopping_for'>\"+i18n.COMMON.fetching_profiles+\"</div>\";\r\n        headerHtml += \"<div class='top_right'>\";\r\n        headerHtml += \"<div id='log_info'><span id='logged_in'></span></div>\";\r\n        headerHtml += \"</div>\";\r\n        headerHtml += \"</div>\";\r\n        return headerHtml;\r\n    }\r\n\r\n    function getHeaderToggler() {\r\n        // *** SizeMe Header toggler\r\n        var headerHtml = \"<div id='sizeme_header_toggler' class='in_content'>\";\r\n        headerHtml += \"</div>\";\r\n        return headerHtml;\r\n    }\r\n\r\n    function getSplashDetailed() {\r\n        // *** SizeMe Splash #2 injection (detailed)\r\n        var headerHtml = \"<div id='sizeme_detailed_splash' class='splash'>\";\r\n        headerHtml += \"<p class='splash_text'>\";\r\n        headerHtml += i18n.SPLASH.detailed_text;\r\n        headerHtml += \"</p>\";\r\n        headerHtml += \"<ul class='splash_choices'>\";\r\n        headerHtml += \"<li class='sign_in'>\";\r\n\t\theaderHtml += \"<a href='\" + SizeMe.contextAddress + \"/?mode=signup' target='_blank' class='a_button' id='sizeme_btn_sign_up' title='\"+i18n.SPLASH.btn_sign_up_label+\"'>\";\r\n\t\theaderHtml += i18n.SPLASH.btn_sign_up_title+\"</a>\";\r\n\t\theaderHtml += \"</li>\";\r\n        headerHtml += \"<li class='log_in'><a href='#' class='a_button' id='sizeme_btn_login' title='\"+i18n.SPLASH.btn_log_in_label+\"'>\"+i18n.SPLASH.btn_log_in_title+\"</a></li>\";\r\n        headerHtml += \"<li class='no_thanks'><td><a href='#' class='a_button' id='sizeme_btn_no_thanks' title='\"+i18n.SPLASH.btn_no_thanks_label+\"'>\"+i18n.SPLASH.btn_no_thanks_title+\"</a></li>\";\r\n        headerHtml += \"</ul></div>\";\r\n        return headerHtml;\r\n    }\r\n\r\n    function getProductSplash() {\r\n        // *** SizeMe Splash in Product page\r\n        var splashHtml = \"<div id='sizeme_product_splash'>\";\r\n\t\tsplashHtml += \"<p>\"+i18n.SPLASH.product_page_splashes[0]+\" \";\r\n\t\tsplashHtml += \"<a href='\" + SizeMe.contextAddress + \"' target='_blank' id='sizeme_product_page_link' title='\"+i18n.SPLASH.product_page_splash_title+\"'></a>\";\r\n\t\tsplashHtml += \"<a href='#' id='sizeme_btn_no_thanks_product_splash' title='\"+i18n.COMMON.close_text+\"'></a>\";\r\n        splashHtml += \"</p></div>\";\r\n        return splashHtml;\r\n    }\r\n\r\n    function findMaxMeasurement() {\r\n        var maxVal = 0;\r\n        sizeme_product.item.measurements.each(function(key, measurement_set) {\r\n            sizeme_product.item.measurements[key].each(function(key_2, value) { maxVal = Math.max(value, maxVal); });\r\n        });\r\n        return maxVal;\r\n    }\r\n\r\n    var DataStorage = (function() {\r\n\r\n        function DataStorage(type) {\r\n            if (storageAvailable(type)) {\r\n                this.storage = window[type];\r\n            } else{\r\n                this.storage = null;\r\n            }\r\n        }\r\n\r\n        DataStorage.prototype.storage = null;\r\n\r\n        function storageAvailable(type) {\r\n            try {\r\n                var _tstorage = window[type];\r\n                var x = '__storage_test__';\r\n                _tstorage.setItem(x, x);\r\n                _tstorage.removeItem(x);\r\n                return true;\r\n            } catch (e) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        DataStorage.prototype.withStorage = function(callback) {\r\n            if (this.storage === null) {\r\n                return;\r\n            }\r\n\r\n            return callback(this.storage);\r\n        };\r\n\r\n        return DataStorage;\r\n    })();\r\n\r\n    var Storage = new DataStorage('sessionStorage');\r\n    var sizeMe;\r\n\r\n    function sizeMeLogout() {\r\n        sizeMe = null;\r\n        clearAuthToken();\r\n    }\r\n\r\n    function clearAuthToken() {\r\n        Storage.withStorage(function(storage) {\r\n            storage.removeItem('authToken');\r\n        });\r\n    }\r\n\r\n    function getAuthToken() {\r\n        var deferred = $.Deferred();\r\n\r\n        Storage.withStorage(function(storage) {\r\n            var storedTokenObj = storage.getItem('authToken'),\r\n                storedToken;\r\n            if (storedTokenObj !== null) {\r\n                storedToken = JSON.parse(storedTokenObj);\r\n                if (storedToken.expires !== undefined) {\r\n                    storedToken.expires = Date.parse(storedToken.expires);\r\n                    // Has token expired?\r\n                    if (storedToken.expires > new Date().getTime()) {\r\n                        if (storedToken.token !== undefined) {\r\n                            deferred.resolve(storedToken.token);\r\n                        } else {\r\n                            deferred.reject(null);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        if (deferred.state() === \"pending\") {\r\n            SizeMe.getAuthToken(function (authTokenObj) {\r\n                if (authTokenObj === null || authTokenObj.token === null) {\r\n                    deferred.reject(null);\r\n                } else {\r\n                    Storage.withStorage(function(storage) {\r\n                        storage.setItem('authToken', JSON.stringify(authTokenObj));\r\n                    });\r\n                    deferred.resolve(authTokenObj.token);\r\n                }\r\n            });\r\n        }\r\n\r\n        return deferred.promise();\r\n    }\r\n\r\n    function sizeMeInit(authorizedCb, unauthorizedCb) {\r\n        var deferred = $.Deferred();\r\n        getAuthToken().then(\r\n            function(authToken) {\r\n                deferred.resolve(new SizeMe(authToken));\r\n            }, function() {\r\n                deferred.reject(null);\r\n            }\r\n        );\r\n\r\n        sizeMe = deferred.promise();\r\n        sizeMe.then(\r\n            function (smObj) {\r\n                if (authorizedCb !== null) {\r\n                    authorizedCb(smObj);\r\n                }\r\n            },\r\n            function () {\r\n                if (unauthorizedCb !== null) {\r\n                    unauthorizedCb();\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    // Load on ready for all pages\r\n    $(function() {\r\n\r\n        var systemsGo = true;\r\n\r\n        i18n = SizeMeI18N.get(sizeme_UI_options.lang);\r\n\r\n\t\t// check options (and service status)\r\n\t\tif (typeof sizeme_options === 'undefined') {\r\n\t\t\tsystemsGo = false;\r\n\t\t} else if (sizeme_options.service_status === \"off\") {\r\n\t\t\tsystemsGo = false;\r\n\t\t}\r\n\r\n        // check data\r\n        if (typeof sizeme_product === 'undefined') {\r\n            systemsGo = false;\r\n        } else if (sizeme_product.item.itemType === 0) {\r\n            systemsGo = false;\r\n        } else if (findMaxMeasurement() === 0) {\r\n            systemsGo = false;\r\n        } \r\n\t\t\r\n\t\t// check existence of size selection element\r\n\t\tif ($(sizeme_UI_options.sizeSelectionContainer).find('select').length === 0) {\r\n\t\t\tsystemsGo = false;\r\n\t\t}\r\n\r\n        if (systemsGo) {\r\n            loadArrows(false); // everyone needs arrows\r\n        }\r\n\r\n        //stuff we do anyway\r\n        addIds(sizeme_UI_options.sizeSelectionContainer);\r\n\r\n        // buttonize\r\n\t\tif (typeof sizeme_options !== 'undefined') {\r\n\t\t\tif (sizeme_options.buttonize === \"yes\") {\r\n\t\t\t\tselectToButtons(sizeme_UI_options.sizeSelectionContainer);\r\n\t\t\t\t$(\"#button_choose\").remove();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// add add to cart event\r\n\t\tif (sizeme_UI_options.addToCartEvent) {\r\n\t\t\t$(sizeme_UI_options.addToCartElement).on(sizeme_UI_options.addToCartEvent, function() {\r\n\t\t\t\tif (isLoggedIn()) {\r\n\t\t\t\t\tSizeMe.trackEvent(\"addToCartSM\", \"Store: Product added to cart by SizeMe user\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tSizeMe.trackEvent(\"addToCart\", \"Store: Product added to cart\");\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\t\t}\r\n\r\n        var getMatchResponseHandler = function(prodId, sizeme_product) {\r\n            if (!systemsGo) {\r\n                return function() {};\r\n            }\r\n            return function(responseMap) {\r\n                var smallestOffset = 9999,  // for recommendation\r\n                    thisVal, thisId, thisData, thisSize;\r\n\r\n                responseMap.each(function(key, result) {\r\n                    var classKey = \".element_for_\" + key;\r\n                    $(classKey)\r\n                        .removeClass('sm-too_small sm-slim sm-regular sm-loose sm-very_loose sm-huge sm-too_big')\r\n                        .addClass('sm-'+result.fitRangeLabel);\r\n\r\n                    // Analyze fit for recommendations\r\n                    var fitOffset = Math.abs(result.totalFit - OPTIMAL_FIT);\r\n                    if (fitOffset < smallestOffset) {\r\n\t\t\t\t\t\t// check if recommended option exists (is for sale)\r\n\t\t\t\t\t\tif ($(\"#input_\" + key).length > 0) {\r\n\t\t\t\t\t\t\tsmallestOffset = fitOffset;\r\n\t\t\t\t\t\t\trecommendedId = key;\r\n\t\t\t\t\t\t\trecommendedLabel = result.fitRangeLabel;\r\n\t\t\t\t\t\t}\r\n                    }\r\n\r\n                    // check if there are results in the first place\r\n                    if (result.accuracy < accuracyThreshold) {\r\n                        $('.slider_bar, .slider_area').hide();\r\n                    } else {\r\n                        $('.slider_bar, .slider_area').show();\r\n                    }\r\n\r\n                    // write data to inputs\r\n                    $(\"#input_\" + key).data(\"fitData\", { totalFit: result.totalFit,\r\n                        fitRangeLabel: result.fitRangeLabel,\r\n                        matchMap: result.matchMap,\r\n                        missingMeasurements: result.missingMeasurements,\r\n                        accuracy: result.accuracy,\r\n                        inputKey: key });\r\n                });\r\n\r\n                // bind change to inputs\r\n                $(sizeme_UI_options.sizeSelectionContainer).find(\"select\").change(function() {\r\n                    thisVal = $(this).val();\r\n                    thisId = '#input_'+thisVal;\r\n                    thisData = $(thisId).data(\"fitData\");\r\n                    thisSize = $(thisId).text();\r\n                    if (thisVal) {\r\n                        updateSlider(thisSize, thisData, (thisVal === recommendedId), sizeme_UI_options.detailedViewContainer, true);\r\n                    }\r\n                    // relay change to cloned and vice versa\r\n                    $(sizeme_UI_options.sizeSelectionContainer).find(\"select\").val(thisVal);\r\n                });\r\n\r\n                // remove existing recommendation\r\n                $(\".sm-buttonset\").find(\".sm-selectable\").removeClass('sm-recommended');\r\n\r\n                // set selection to recommendation on first match\r\n                if (sizeme_local_options.firstRecommendation) {\r\n                    // select recommended\r\n                    $(sizeme_UI_options.sizeSelectionContainer).find(\"select\").val(recommendedId);\r\n                    // remove existing active\r\n                    $(\".sm-buttonset\").find(\".sm-selectable\").removeClass('sm-state-active');\r\n                    // add class\r\n                    $(\".element_for_\" + recommendedId).addClass('sm-recommended sm-state-active');\r\n                    var recommendedInput = $(\"#input_\" + recommendedId);\r\n                    if (recommendedInput.data(\"fitData\")) {\r\n                        thisData = recommendedInput.data(\"fitData\");\r\n                        thisSize = recommendedInput.text();\r\n                        updateSlider(thisSize, thisData, true, sizeme_UI_options.detailedViewContainer, true);\r\n                    }\r\n                    sizeme_local_options.firstRecommendation = false;\r\n                } else {\r\n                    thisId = '#input_'+$(sizeme_UI_options.sizeSelectionContainer).find(\"select\").val();\r\n                    if ($(thisId).data(\"fitData\")) {\r\n                        thisData = $(thisId).data(\"fitData\");\r\n                        thisSize = $(thisId).text();\r\n                        updateSlider(thisSize, thisData, true, sizeme_UI_options.detailedViewContainer, true);\r\n                    }\r\n                }\r\n            };\r\n            // end of function \tgetMatchResponseHandler\r\n        };\r\n\r\n        var matchErrorHandler = function() {\r\n\t\t\t// this is called when the match function returns an error.  This is most likely due to a wrong or unadded itemType and only visible when the user is logged in.\r\n\t\t\t// if the itemType is\r\n\t\t\t$(\".sizeme_slider\").hide();\r\n\t\t\tconsole.error(\"SizeMe: error in match function.  Please contact your local SizeMe dealer.\");\r\n\r\n            // end of function \tmatchErrorHandler\r\n        };\r\n\r\n\r\n        var loggedInCb = function(sizeMeObj) {\r\n\r\n            function setProfileLink() {\r\n                if (selectedProfile === null) {\r\n                    linkToSelectedProfile = SizeMe.contextAddress + \"/account/profiles.html\";\r\n                } else {\r\n                    linkToSelectedProfile = SizeMe.contextAddress + \"/account/profiles/\" + selectedProfile + \"/profile.html\";\r\n                }\r\n            }\r\n\r\n            var doProfileChange = function(newValue) {\r\n                selectedProfile = newValue;\r\n                setProfileLink();\r\n\r\n                if (selectedProfile === null) {\r\n                    eraseCookie(\"sizeme_profileId\");\r\n                    goWriteMessages();\r\n                } else {\r\n                    $(\".profileSelect\").val(selectedProfile);\r\n                    createCookie(\"sizeme_profileId\", selectedProfile, cookieLifetime);\r\n\r\n                    if (typeof sizeme_product !== 'undefined') {\r\n                        var prodId = null;\r\n                        var tmpItem = $.extend({}, sizeme_product.item);\r\n                        var itemType = tmpItem.itemType;\r\n                        if (itemType.indexOf('.') < 0) {\r\n                            tmpItem.itemType = itemType.split('').join('.');\r\n                        }\r\n                        sizeMeObj.match(new SizeMe.FitRequest(selectedProfile, tmpItem), getMatchResponseHandler(prodId, sizeme_product), matchErrorHandler);\r\n                    }\r\n                    SizeMe.trackEvent(\"activeProfileChanged\", \"Store: Active profile changed\");\r\n                }\r\n                $('#logged_in_link').attr(\"href\", linkToSelectedProfile);\r\n                // end of function  doProfileChange\r\n            };\r\n\r\n            eraseCookie(\"sizeme_no_thanks\");\r\n            eraseCookie(\"sizeme_no_product_splash\");\r\n\r\n            // remove existing (if exists)\r\n            $(\"#sizeme_header\").remove();\r\n            $(\"#popup_opener\").remove();\r\n            $(\"#sizeme_product_splash\").remove();\r\n            $(\"#sizeme_detailed_view_content\").dialog(\"destroy\").remove();\r\n\r\n            // *** SizeMe Magic\r\n            if (sizeMeObj !== null) {\r\n                sizeMeObj.fetchProfilesForAccount(function (profileList) {\r\n                    var cookieProfile = readCookie(\"sizeme_profileId\");\r\n                    var $i = 0;\r\n                    var $new = \"<div id='sizeme_header_container'>\"+getStandardHeader()+\"</div>\";\r\n\r\n                    // Prepend header to body\r\n                    $(sizeme_UI_options.appendContentTo).append(getSliderHtml(systemsGo));\r\n                    $(\".sizeme_slider .slider_text_below\").append($new);\r\n                    $(\"#sizeme_header.in_content\").find(\"#logo\").on(\"click\", function() {\r\n                        $(\"#sizeme_header.in_content\").toggleClass(\"opened\");\r\n                    });\r\n\r\n                    if (profileList.length > 0) {\r\n                        selectedProfile = profileList[0].id;\r\n                        $.each(profileList, function () {\r\n                            if (this.id === cookieProfile) {\r\n                                selectedProfile = this.id;\r\n                                return false;\r\n                            }\r\n                        });\r\n\r\n                        writeDetailedWindow(false);\r\n                        moveSlider(OPTIMAL_FIT, false);\r\n\r\n                        $(\".shopping_for\").empty().html(\"<span class='shopping_for_text'>\"+i18n.COMMON.shopping_for+\": </span>\")\r\n                            .append(function () {\r\n                                var select = document.createElement(\"select\");\r\n                                select.className = \"profileSelect\";\r\n                                select.id = \"id_profileSelect_\" + (++$i);\r\n                                return select;\r\n                            });\r\n                        $.each(profileList, function () {\r\n                            $(\"<option>\").appendTo(\".profileSelect\")\r\n                                .attr(\"value\", this.id)\r\n                                .text(this.profileName);\r\n                        });\r\n                        $('.profileSelect')\r\n                            .val(selectedProfile)\r\n                            .change(function () {\r\n                                doProfileChange(this.value);\r\n                            });\r\n                    } else {\r\n                        selectedProfile = null;\r\n                        setProfileLink();\r\n                        writeDetailedWindow(false);\r\n                        updateDetailedTable();\r\n                        $('.slider_bar, .slider_area').hide();\r\n                        $(\".shopping_for\").empty();\r\n                        $(\".sizeme_header_content .shopping_for\")\r\n                            .html(\"<span class='shopping_for_text no-profile'>\"+i18n.MESSAGE.no_profiles+\"</span>\");\r\n                        $(\".sizeme_detailed_section .shopping_for\")\r\n                            .append(\r\n                                $(\"<span>\").addClass(\"shopping_for_text no-profile\")\r\n                                    .html(i18n.MESSAGE.no_profiles+\" \"+i18n.COMMON.go_to+\r\n                                        \"<a id='logged_in_link' href='\" + linkToSelectedProfile + \"' target='_blank'>\" + i18n.COMMON.my_profiles + \"</a> \"+i18n+COMMON.and_create_one)\r\n                            );\r\n                    }\r\n\r\n                    $('#logged_in').html(\"<a id='logged_in_link' href='#' target='_blank'>\" + i18n.COMMON.my_profiles + \"</a>\");\r\n\r\n                    // Yell change\r\n                    doProfileChange(selectedProfile);\r\n                });\r\n            }\r\n\r\n            $(\"#logout\").click(loggedOutCb);\r\n\r\n            // end of function \tloggedInCb\r\n        };\r\n\r\n        var loggedOutCb = function() {\r\n\r\n            loadArrows(true);\r\n\r\n            // Size Guide for non-loving users\r\n            writeDetailedWindow(true);\r\n            updateDetailedTable();\r\n\r\n\t\t\t// Makia live temporary exception\r\n\t\t\t// Show size guide text only if there actually is a size guide (otherwise hidden with css)\r\n\t\t\t$(\".sizeme p\").show();\r\n\r\n            // bind change to select\r\n            $(sizeme_UI_options.sizeSelectionContainer).find(\"select\").change(function() {\r\n                var thisVal = $(this).val();\r\n                // relay change to cloned and vice versa\r\n                $(sizeme_UI_options.sizeSelectionContainer).find(\"select\").val(thisVal);\r\n                updateDetailedTable(\"\", thisVal);\r\n            });\r\n\r\n            if (sizeme_options.service_status === \"on\") {\r\n                var splashContent;\r\n                // Add splash content in detailed\r\n\t\t\t\tsplashContent = getSplashDetailed();\r\n\t\t\t\tif (noThanks()) {\r\n\t\t\t\t\tsplashContent = $(splashContent).hide();\r\n\t\t\t\t}\r\n\t\t\t\t$(\"#sizeme_detailed_view_content\").append(splashContent);\r\n\r\n                // login button\r\n                $(\"#sizeme_btn_login\").click(function() {\r\n\t\t\t\t\tSizeMe.trackEvent(\"clickLogin\", \"Store: Login clicked\");\r\n                    clearAuthToken();\r\n                    SizeMe.loginFrame(function() {\r\n                        sizeMeInit(loggedInCb);\r\n                    });\r\n                    return false;\r\n                });\r\n\r\n                $(\"#sizeme_btn_sign_up\").click(function () {\r\n\t\t\t\t\tSizeMe.trackEvent(\"clickSignUp\", \"Store: Sign up clicked\");\r\n                    clearAuthToken();\r\n                    return true;\r\n                });\r\n\r\n                // no thanks button\r\n                $(\"#sizeme_btn_no_thanks\").on(\"click\", function() {\r\n                    SizeMe.trackEvent(\"noThanks\", \"Store: SizeMe, no thanks\");\r\n                    createCookie(\"sizeme_no_thanks\", \"true\", cookieLifetime);\r\n                    $(\".splash\").hide();\r\n\t\t\t\t\t$(\"#sizeme_btn_no_thanks_product_splash\").trigger(\"click\");\t\t// also close possible product splasher\r\n                    return false;\r\n                });\r\n\r\n\t\t\t\t// Product page splash\r\n\t\t\t\tif (!noProductSplash()) {\r\n\t\t\t\t\t$(sizeme_UI_options.appendSplashTo).append(getProductSplash());\r\n\t\t\t\t\t$(\"#sizeme_btn_no_thanks_product_splash\").on(\"click\", function() {\r\n\t\t\t\t\t\tSizeMe.trackEvent(\"noProductSplash\", \"Store: Product splash closed\");\r\n\t\t\t\t\t\tcreateCookie(\"sizeme_no_product_splash\", \"true\", cookieLifetime);\r\n\t\t\t\t\t\t$(\"#sizeme_product_splash\").slideUp();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#sizeme_product_page_link\").on(\"click\", function() {\r\n\t\t\t\t\t\tSizeMe.trackEvent(\"clickProductSplash\", \"Store: Product splash clicked\");\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n            }\r\n\r\n            // end of function \tloggedOutCb\r\n        };\r\n\r\n        if (systemsGo) {\r\n            if (noThanks()) {\r\n                SizeMe.trackEvent(\"productPageNoSM\", \"Store: Product page load, SizeMe refused\");\r\n                loggedOutCb();\r\n            } else {\r\n                sizeMeInit(function (smObj) {\r\n                    SizeMe.trackEvent(\"productPageLoggedIn\", \"Store: Product page load, logged in\");\r\n                    loggedInCb(smObj);\r\n                }, function () {\r\n                    SizeMe.trackEvent(\"productPageLoggedOut\", \"Store: Product page load, logged out\");\r\n                    loggedOutCb();\r\n                });\r\n            }\r\n        }\r\n        // *** End\r\n    });\r\n\r\n    function isLoggedIn() {\r\n        return sizeMe !== null && sizeMe.state() === \"resolved\";\r\n    }\r\n\r\n    // Cookie functions\r\n    function createCookie(name,value,days) {\r\n        var expires;\r\n        if (days) {\r\n            var date = new Date();\r\n            date.setTime(date.getTime()+(days*24*60*60*1000));\r\n            expires = \"; expires=\"+date.toGMTString();\r\n        }\r\n        else {\r\n            expires = \"\";\r\n        }\r\n        document.cookie = name+\"=\"+value+expires+\"; path=/\";\r\n    }\r\n\r\n    function readCookie(name) {\r\n        var ca = document.cookie.split(';'), c;\r\n        for (var i=0;i<ca.length;i++) {\r\n            c = ca[i].trim().split('=');\r\n            if (c[0] === name) {\r\n                return c[1];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    function eraseCookie(name) {\r\n        createCookie(name,\"\",-1);\r\n    }\r\n\r\n})(jQuery);\r\n"],"sourceRoot":"/source/"}